# rm -rf 51pwn/xx.json lists.txt
#
set -x
xxNm=`echo $1|base64`
wget  -O 51pwn/${xxNm}.json -c 'https://api.shodan.io/shodan/host/search?key=FfH1z0IR5MiktkLbfMlQD93M3lPe32vH&page=1&query=$1'
# cat 51pwn/xx.json|jq '.matches[].ip_str'|sed 's/"//g'|xargs -I % echo "https://%:5986">>lists.txt
cat 51pwn/${xxNm}.json|jq '.matches[]|[.ip_str,.port]|@csv'|sed 's/["\\]//g'|sed 's/,/:/g'|xargs -I % echo "https://%" >>${xxNm}.txt
# echo ${xxNm}.txt

cat ${xxNm}.txt|nuclei -duc -t $2 -v



# X-AspNet-Version http.title:"Outlook" -"x-owa-version"
# echo 'X-AspNet-Version http.title:"Outlook" -"x-owa-version"'|base64
# WC1Bc3BOZXQtVmVyc2lvbiBodHRwLnRpdGxlOiJPdXRsb29rIiAtIngtb3dhLXZlcnNpb24iCg==

# Ingtb3dhLXZlcnNpb24iICJJRT1FbXVsYXRlSUU3IiBodHRwLmZhdmljb24uaGFzaDo0NDI3NDkzOTIK
# wget  -O 51pwn/WC1Bc3BOZXQtVmVyc2lvbiBodHRwLnRpdGxlOiJPdXRsb29rIiAtIngtb3dhLXZlcnNpb24iCg.json -c 'https://api.shodan.io/shodan/host/search?key=FfH1z0IR5MiktkLbfMlQD93M3lPe32vH&page=1&query=X-AspNet-Version http.title:"Outlook" -"x-owa-version"'

# cat 51pwn/WC1Bc3BOZXQtVmVyc2lvbiBodHRwLnRpdGxlOiJPdXRsb29rIiAtIngtb3dhLXZlcnNpb24iCg.json|jq '.matches[]|[.ip_str,.port]|@csv'|sed 's/["\\]//g'|sed 's/,/:/g'|xargs -I % echo "https://%" >>WC1Bc3BOZXQtVmVyc2lvbiBodHRwLnRpdGxlOiJPdXRsb29rIiAtIngtb3dhLXZlcnNpb24iCg.txt
