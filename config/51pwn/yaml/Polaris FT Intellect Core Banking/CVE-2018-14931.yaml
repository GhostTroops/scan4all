id: CVE-2018-14931
info:
  name: Polarisft Intellect Core Banking Software Version 9.7.1 - Open Redirect
  author:
  - 0x_akoko
  description: |-
    Polaris FT Intellect Core Banking 9.7.1 URL重定向漏洞
    Polaris Consulting＆Services FT Intellect Core Banking是印度Polaris Consulting＆Services公司的一款智能核心银行解决方案。

    Polaris FT Intellect Core Banking 9.7.1版本中的Core和Portal模块存在URL重定向漏洞。该漏洞源于网络系统或产品未对输入的数据进行正确的验证。
  severity: medium
  remediation: |-
    官方修复方案：
    1、目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    http://www.polarisft.com/

    临时修复方案：
    1、代码固定跳转地址，不让用户控制变量。
    2、跳转目标地址采用白名单映射机制、只对合法的 URL 做跳转。
    3、合理充分的校验校验跳转的目标地址，非己方地址时告知用户跳转风险。
requests:
- matchers:
  - type: regex
    part: header
    regex:
    - (?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)?(?:[a-zA-Z0-9\-_\.@]*)bing\.com\/?(\/|[^.].*)?$
  path:
  - '{{BaseURL}}/IntellectMain.jsp?IntellectSystem=https://www.bing.com'
  method: GET
