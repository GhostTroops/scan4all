id: CVE-2020-2551
info:
  name: Unauthenticated Oracle WebLogic Server Remote Code Execution
  author:
  - dwisiswant0
  description: |-
    Weblogic iiop协议 反序列化
    Oracle Fusion Middleware（Oracle融合中间件）是美国甲骨文（Oracle）公司的一套面向企业和云环境的业务创新平台。该平台提供了中间件、软件集合等功能。WebLogic Server是其中的一个适用于云环境和传统环境的应用服务器组件。

    Oracle Fusion Middleware中的WebLogic Server的WLS Core Components组件存在安全漏洞。攻击者可利用该漏洞控制Oracle WebLogic Server，影响数据的保密性、完整性和可用性。以下产品及版本受到影响：Oracle Fusion Middleware WebLogic Server 10.3.6.0.0版本，WebLogic Server 12.1.3.0.0版本，WebLogic Server 12.2.1.3.0版本和WebLogic Server 12.2.1.4.0版本。
  severity: critical
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：
    https://www.oracle.com/security-alerts/cpujan2020.html

    临时修复方案：
    1、不要把用户的输入或者是用户可控的参数直接放进反序列化的操作中去。
    2、在进入反序列化函数之前,对参数进行限制过滤。
    3、给反序列数据加密签名，并确保解密在反序列之前
    4、给反序列化接口添加认证授权
network:
- matchers:
  - type: word
    condition: and
    words:
    - GIOP
    - weblogic
  matchers-condition: and
  host:
  - '{{Hostname}}'
  inputs:
  - data: '{{hex_decode(''47494f50010200030000001700000002000000000000000b4e616d6553657276696365'')}}'
  read-size: 1024
