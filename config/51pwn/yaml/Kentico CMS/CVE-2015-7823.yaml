id: CVE-2015-7823
info:
  name: Kentico CMS 8.2 Open Redirection
  author:
  - l0ne1y
  description: "Kentico CMS 开放重定向漏洞 \n Kentico CMS是美国Kentico软件公司的一套基于ASP.NET的内容管理系统（CMS）。该系统主要由两大工具组成：Kentico
    CMS Desk是用于编辑网页中的内容；Kentico CMS Controls是用于编辑和控制网页中各种元素。\n\nKentico CMS 8.2版本至8.2.41版本的CMSPages/GetDocLink.ashx文件中存在开放重定向漏洞。远程攻击者可借助‘link’参数中的URL利用该漏洞将用户重定向到任意Web站点，实施钓鱼攻击。 "
  severity: medium
  remediation: |-
    官方修复方案：<br />1、升级系统至无漏洞版本，或于官网下载安全补丁
    http://www.kentico.com/

    临时修复方案：<br />1、代码固定跳转地址，不让用户控制变量。<br />2、跳转目标地址采用白名单映射机制、只对合法的 URL 做跳转。<br />3、合理充分的校验校验跳转的目标地址，非己方地址时告知用户跳转风险。
requests:
- matchers:
  - type: regex
    part: header
    regex:
    - (?m)^(?:Location\s*?:\s*?)(?:https?://|//)?(?:[a-zA-Z0-9\-_\.@]*)example\.com.*$
  path:
  - '{{BaseURL}}/CMSPages/GetDocLink.ashx?link=https://example.com/'
  method: GET
