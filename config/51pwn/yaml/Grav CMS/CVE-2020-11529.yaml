id: CVE-2020-11529
info:
  name: Grav <1.7  - Open Redirect
  author:
  - 0x_akoko
  tags:
  - cve
  - cve2019
  - redirect
  - grav
  - getgrav
  description: |-
    Grav 输入验证错误漏洞
    Grav是一套可扩展的用于个人博客、小型内容发布平台和单页产品展示的CMS（内容管理系统）。

    Grav 1.6.23之前版本中的Common/Grav.php文件存在输入验证错误漏洞。该漏洞源于网络系统或产品未对输入的数据进行正确的验证。
  reference:
  - https://github.com/getgrav/grav/issues/3134
  - https://www.cvedetails.com/cve/cve-2020-11529
  - https://nvd.nist.gov/vuln/detail/cve-2020-11529
  - https://github.com/getgrav/grav/commit/2eae104c7a4bf32bc26cb8073d5c40464bfda3f7
  severity: medium
  classification:
    cve-id:
    - cve-2020-11529
    cwe-id:
    - cwe-601
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
  remediation: |-
    目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://github.com/getgrav/grav/commit/2eae104c7a4bf32bc26cb8073d5c40464bfda3f7

    1、配置所有的安全机制
    2、最小原则，关掉或限制不使用的服务
    3、更改默认账户信息
    4、使用日志和警报
    5、回显信息不显示任何与实际错误相关的信息
    6、检查和修复安全配置项
requests:
- matchers:
  - type: regex
    part: header
    regex:
    - (?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)?(?:[a-zA-Z0-9\-_\.@]*)example\.com\/?(\/|[^.].*)?$
  path:
  - '{{BaseURL}}/%252f%255cexample.com%252fa%253fb/'
  method: GET
