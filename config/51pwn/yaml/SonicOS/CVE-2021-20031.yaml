id: CVE-2021-20031
info:
  name: Sonicwall SonicOS 7.0 - Host Header Injection
  author:
  - l0ne1y
  description: |-
    SonicOS 输入验证错误漏洞
    Sonicwall SonicWall SonicOS是美国SonicWall（Sonicwall）公司的一套专为SonicWall防火墙设备设计的操作系统。

    SonicOS存在输入验证错误漏洞，该漏洞源于系统对于主机头缺乏有效的验证与转义。主机头重定向漏洞可能允许远程攻击者可利用该漏洞将防火墙管理用户重定向到任意web域。
  severity: medium
  remediation: |
    官方修复建议：
    目前厂商已发布升级补丁以修复漏洞，补丁获取链接：

    https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0019

    临时修复建议：
    1、代码固定跳转地址，不让用户控制变量。<br/>2、跳转目标地址采用白名单映射机制、只对合法的 URL 做跳转。<br/>3、合理充分的校验校验跳转的目标地址，非己方地址时告知用户跳转风险。
requests:
- matchers:
  - type: word
    condition: and
    part: body
    words:
    - https://{{randstr}}.tld/auth.html
    - Please be patient as you are being re-directed
  - type: status
    status:
    - 200
  matchers-condition: and
  raw:
  - |
    GET / HTTP/1.1
    Host: {{randstr}}.tld
