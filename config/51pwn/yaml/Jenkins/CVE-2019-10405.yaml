id: CVE-2019-10405
info:
  name: Diagnostic page exposed Cookie HTTP header
  author:
  - l0ne1y
  tags:
  - cve
  - cve2019
  - jenkins
  description: |+
    CloudBees Jenkins和LTS 信息泄露漏洞
    CloudBees Jenkins（Hudson Labs）是美国CloudBees公司的一套基于Java开发的持续集成工具。该产品主要用于监控持续的软件版本发布/测试项目和一些定时执行的任务。LTS是CloudBeesJenkins的一个长期支持版本。

    CloudBees Jenkins 2.196及之前版本和LTS 2.176.3及之前版本中存在信息泄露漏洞。该漏洞源于网络系统或产品在运行过程中存在配置等错误。未授权的攻击者可利用漏洞获取受影响组件敏感信息。

  reference:
  - https://nvd.nist.gov/vuln/detail/cve-2019-10405
  - https://jenkins.io/security/advisory/2019-09-25/#security-1505
  - http://www.openwall.com/lists/oss-security/2019/09/25/3
  severity: medium
  metadata:
    shodan-query: http.favicon.hash:81586312
  classification:
    cve-id:
    - cve-2019-10405
    cwe-id:
    - cwe-200
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 4.3
  remediation: |-
    官方修复方案：
    1.目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://jenkins.io/security/advisory/2019-09-25/#SECURITY-1548
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: word
    condition: and
    part: header
    words:
    - text/html
    - x-jenkins
    case-insensitive: true
  - type: word
    condition: and
    part: body_2
    words:
    - Cookie
    - JSESSIONID
  extractors:
  - type: kval
    kval:
    - x_jenkins
  matchers-condition: and
  raw:
  - |
    GET {{BaseURL}}/whoAmI/ HTTP/1.1
    Host: {{Hostname}}
  - |
    GET {{BaseURL}}/whoAmI/ HTTP/1.1
    Host: {{Hostname}}
  cookie-reuse: true
  req-condition: true
