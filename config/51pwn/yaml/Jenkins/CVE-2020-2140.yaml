id: CVE-2020-2140
info:
  name: Jenkin Audit Trail <=3.2 - Cross-Site Scripting
  author:
  - l0ne1y
  tags:
  - cve
  - cve2020
  - jenkins
  - xss
  - plugin
  description: |+
    CloudBees Jenkins Audit Trail Plugin 跨站脚本漏洞
    CloudBees Jenkins（Hudson Labs）是美国CloudBees公司的一套基于Java开发的持续集成工具。该产品主要用于监控持续的软件版本发布/测试项目和一些定时执行的任务。Audit Trail Plugin是使用在其中的一个审核日志记录插件。

    CloudBees Jenkins中的Audit Trail Plugin 3.2及之前版本存在跨站脚本漏洞。该漏洞源于WEB应用缺少对客户端数据的正确验证。攻击者可利用该漏洞执行客户端代码。

  reference:
  - https://www.jenkins.io/security/advisory/2020-03-09/
  - https://nvd.nist.gov/vuln/detail/cve-2020-2140
  - https://jenkins.io/security/advisory/2020-03-09/#security-1722
  - http://www.openwall.com/lists/oss-security/2020/03/09/1
  severity: medium
  classification:
    cve-id:
    - cve-2020-2140
    cwe-id:
    - cwe-79
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
  remediation: |-
    官方修复方案：
    1.目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://jenkins.io/security/advisory/2020-03-09/#SECURITY-1635
requests:
- matchers:
  - type: word
    part: body
    words:
    - <h1>sample
  - type: word
    part: header
    words:
    - text/html
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/descriptorByName/AuditTrailPlugin/regexCheck?value=*j%3Ch1%3Esample'
  - '{{BaseURL}}/jenkins/descriptorByName/AuditTrailPlugin/regexCheck?value=*j%3Ch1%3Esample'
  method: GET
