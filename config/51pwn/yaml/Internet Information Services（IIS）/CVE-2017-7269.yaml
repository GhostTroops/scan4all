id: CVE-2017-7269
info:
  name: Windows Server 2003 & IIS 6.0 - Remote Code Execution
  author:
  - l0ne1y
  description: |-
    Microsoft Internet Information Services 缓冲区错误漏洞
    Microsoft Windows Server 2003 R2是美国微软（Microsoft）公司发布的一套服务器操作系统。Internet Information Services（IIS）是一套运行于Microsoft Windows中的互联网基本服务。

    Microsoft Windows Server 2003 R2中的IIS 6.0版本中的WebDAV服务的‘ScStoragePathFromUrl’函数存在缓冲区溢出漏洞。远程攻击者可通过发送特制的PROPFIND请求利用该漏洞执行任意代码。
  severity: critical
  remediation: |-
    目前厂商已发布升级补丁以修复漏洞，补丁获取链接:

    https://technet.microsoft.com/en-us/library/security/4025685.aspx
requests:
- matchers:
  - type: word
    part: header
    words:
    - IIS/6.0
  - type: dsl
    condition: or
    dsl:
    - regex("<DAV:sql>", dasl)
    - regex("[\d]+(,\s+[\d]+)?", dav)
    - regex(".*?PROPFIND", public)
    - regex(".*?PROPFIND", allow)
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}'
  method: OPTIONS
