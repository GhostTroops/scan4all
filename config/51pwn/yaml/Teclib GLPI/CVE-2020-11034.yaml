id: CVE-2020-11034
info:
  name: GLPI <9.4.6 - Open Redirect
  author:
  - pikpikcu
  tags:
  - cve
  - cve2020
  - redirect
  - glpi
  description: |-
    Teclib GLPI 输入验证错误漏洞
    Teclib GLPI是法国Teclib公司的一套开源的IT资产管理套件。该套件包含设备状态管理、资产清单存储、管理流程和工作日志管理等功能。

    Teclib GLPI 9.4.6之前版本中存在安全漏洞。攻击者可利用该漏洞绕过开放重定向保护。
  reference:
  - https://github.com/glpi-project/glpi/security/advisories/ghsa-gxv6-xq9q-37hg
  - https://github.com/glpi-project/glpi/archive/9.4.6.zip
  - https://nvd.nist.gov/vuln/detail/cve-2020-11034
  severity: medium
  classification:
    cve-id:
    - cve-2020-11034
    cwe-id:
    - cwe-601
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
  remediation: |+
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：https://github.com/glpi-project/glpi/security/advisories/GHSA-gxv6-xq9q-37hg

    临时修复方案：
    1、代码固定跳转地址，不让用户控制变量。
    2、跳转目标地址采用白名单映射机制、只对合法的 URL 做跳转。
    3、合理充分的校验校验跳转的目标地址，非己方地址时告知用户跳转风险。

requests:
- matchers:
  - type: regex
    part: header
    regex:
    - (?m)^(?:Location\s*?:\s*?)(?:https?://|//)?(?:[a-zA-Z0-9\-_]*\.)?evil\.com(?:\s*?)$
  path:
  - '{{BaseURL}}/index.php?redirect=/\/evil.com/'
  - '{{BaseURL}}/index.php?redirect=//evil.com'
  method: GET
