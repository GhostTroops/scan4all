id: CVE-2021-38751
info:
  name: ExponentCMS <= 2.6 Host Header Injection
  author:
  - dwisiswant0
  tags:
  - cve
  - cve2021
  - exponentcms
  description: |-
    ExponentCMS HTTP 主机标头攻击
    在 ExponentCMS 2.6 及更低版本的 /exponent_constants.php 中存在 HTTP 主机标头攻击。修改后的 HTTP 标头可以将网页上的链接更改为任意值，从而导致 MITM 的可能攻击向量。
  reference:
  - https://nvd.nist.gov/vuln/detail/cve-2021-38751
  - https://github.com/exponentcms/exponent-cms/issues/1544
  - https://github.com/exponentcms/exponent-cms/blob/a9fa9358c5e8dc2ce7ad61d7d5bea38505b8515c/exponent_constants.php#l56-l64
  severity: medium
  classification:
    cve-id:
    - cve-2021-38751
    cwe-id:
    - cwe-116
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    cvss-score: 4.3
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：https://github.com/exponentcms/exponent-cms/issues/1544
requests:
- matchers:
  - type: word
    condition: and
    part: body
    words:
    - '{{randstr}}.tld'
    - EXPONENT.PATH
    - EXPONENT.URL
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}'
  method: GET
  headers:
    Host: '{{randstr}}.tld'
