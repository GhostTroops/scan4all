id: CVE-2022-24288
info:
  name: Apache Airflow OS Command Injection
  author:
  - l0ne1y
  description: |-
    Apache Airflow操作系统命令注入漏洞
    Apache Airflow是美国阿帕奇（Apache）基金会的一套用于创建、管理和监控工作流程的开源平台。该平台具有可扩展和动态监控等特点。

    Apache Airflow 存在操作系统命令注入漏洞，该漏洞的存在是由于某些示例dag中不正确的输入验证。远程未经身份验证的攻击者可利用该漏洞可以传递专门制作的HTTP请求，并在目标系统上执行任意操作系统命令。该漏洞允许远程攻击者可利用该漏洞在目标系统上执行任意shell命令。
  severity: critical
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：
    https://airflow.apache.org/

    临时修复方案：
    1、删除或禁用默认DAG（可自行删除或在配置文件中禁用默认配置DAGload_examples=False）
requests:
- matchers:
  - type: word
    words:
    - foo was passed in via Airflow CLI Test command with value {{ params.foo }}
  path:
  - '{{BaseURL}}/admin/airflow/code?root=&dag_id=example_passing_params_via_test_command'
  - '{{BaseURL}}/code?dag_id=example_passing_params_via_test_command'
  method: GET
  stop-at-first-match: true
