id: CVE-2020-7943
info:
  name: Puppet Server and PuppetDB sensitive information disclosure
  author:
  - c-sh0
  description: |-
    Puppet Server&PuppetDB 敏感信息泄露漏洞
    Puppet和Puppet Server都是美国Puppet（Puppet）实验室的产品。Puppet是一套基于客户端/服务器（C/S）架构的配置管理工具，它可用于管理配置文件、用户、cron任务、软件包、系统服务等。Puppet Enterprise是Puppet的企业版。PuppetDB是Puppet的下一代开源存储服务，它可用于管理所有平台生成的数据存储和检索。Puppet Server是一款用于将配置从主服务器推送到其他服务器的软件。

    Puppet Enterprise、Puppet Server和PuppetDB中存在信息泄露漏洞。远程攻击者可利用该漏洞获取敏感信息。以下产品及版本受到影响：Puppet Enterprise 2018.1.13之前2018.1.x版本，2019.4.0之前版本；Puppet Server 6.9.1之前版本，5.3.12之前版本；PuppetDB 6.9.1之前版本，5.2.13之前版本。
  severity: high
  remediation: |-
    官方修复方案：
    1、目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://puppet.com/security/cve/CVE-2020-7943/

    临时修复方案：
    1、去除页面中涉及的敏感信息或删除泄露信息页面
    2、将敏感信息进行加密存储，非必要不可发送前端
    3、发送敏感信息时需加密传输，如有必要需脱敏处理
    4、对必须发送的敏感数据或页面请求接口做好严格的权限认证
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: word
    part: header
    words:
    - application/json
  - type: word
    part: body
    words:
    - trapperkeeper
  matchers-condition: and
  path:
  - '{{BaseURL}}/metrics/v1/mbeans'
  method: GET
