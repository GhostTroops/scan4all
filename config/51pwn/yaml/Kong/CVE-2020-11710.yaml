id: CVE-2020-11710
info:
  name: Kong Admin <=2.03 - Admin API Access
  author:
  - pikpikcu
  description: |-
    Kong Admin Rest API未授权访问漏洞
    Kong API 网关是目前最受欢迎的云原生 API 网关之一，它通过插件的形式提供负载均衡等多重功能。

    Kong 使用 Kong Admin Rest API 作为管理 Kong Proxy 能力的关键入口。在 2.0.3 版本之前，当企业遵循官方文档或默认配置使用 Docker 容器的方式搭建 Kong API 网关时，会在默认情况下将未经鉴权的Admin Rest API 对公网开放，导致攻击者可以通过未授权访问Admin Rest API，从而控制Kong API网关。
  severity: high
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：
    https://github.com/Kong/docker-kong/commit/dfa095cadf7e8309155be51982d8720daf32e31c

    临时修复方案：
    1、Kong Admin Rest API 默认监听端口是 8001 和 8444 ，建议将其设置为绑定在本地。
requests:
- matchers:
  - type: word
    condition: and
    part: body
    words:
    - Welcome to kong
    - configuration
    - kong_env
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}'
  method: GET
