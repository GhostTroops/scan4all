id: CVE-2017-17562
info:
  name: Embedthis GoAhead RCE
  author:
  - l0ne1y
  description: "Embedthis GoAhead 安全漏洞 \n Embedthis GoAhead是美国Embedthis软件公司的一款嵌入式Web服务器。\n\nEmbedthis
    GoAhead 3.6.5之前的版本中存在安全漏洞。远程攻击者可利用该漏洞执行代码。 "
  severity: high
  remediation: |-
    官方修复方案：<br />1、升级系统至无漏洞版本，或于官网下载安全补丁。
    https://github.com/embedthis/goahead/commit/6f786c123196eb622625a920d54048629a7caa74

    临时修复方案：<br />1、在执行涉及到可以将字符串作为代码执行的函数时，需要严格验证用户传递的参数，同时尽量避免用户控制参数。<br />2、使用escapeshellarg函数处理相关参数。Escapeshellarg函数会将任何引起参数或命令结束的字符进行转义，如单引号“’”会被转义为“\\’”，双引号“””会被转义为“\\””，分号“;”会被转义为“\\;”，这样escapeshellarg会将参数内容限制在一对单引号或双引号里面，转义参数中所包含的单引号或双引号，使其无法对当前执行进行截断，实现防范命令注入攻击的目的。
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: word
    condition: and
    words:
    - environment variable
    - display library search paths
  matchers-condition: and
  raw:
  - |
    GET /cgi-bin/{{endpoint}}?LD_DEBUG=help HTTP/1.1
    Host: {{Hostname}}
    Accept: */*
  payloads:
    endpoint:
    - admin
    - apply
    - non-CA-rev
    - cgitest
    - checkCookie
    - check_user
    - chn/liveView
    - cht/liveView
    - cnswebserver
    - config
    - configure/set_link_neg
    - configure/swports_adjust
    - eng/liveView
    - firmware
    - getCheckCode
    - get_status
    - getmac
    - getparam
    - guest/Login
    - home
    - htmlmgr
    - index
    - index/login
    - jscript
    - kvm
    - liveView
    - login
    - login.asp
    - login/login
    - login/login-page
    - login_mgr
    - luci
    - main
    - main-cgi
    - manage/login
    - menu
    - mlogin
    - netbinary
    - nobody/Captcha
    - nobody/VerifyCode
    - normal_userLogin
    - otgw
    - page
    - rulectl
    - service
    - set_new_config
    - sl_webviewer
    - ssi
    - status
    - sysconf
    - systemutil
    - t/out
    - top
    - unauth
    - upload
    - variable
    - wanstatu
    - webcm
    - webmain
    - webproc
    - webscr
    - webviewLogin
    - webviewLogin_m64
    - webviewer
    - welcome
  stop-at-first-match: true
