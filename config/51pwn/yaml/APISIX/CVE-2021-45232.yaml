id: CVE-2021-45232
info:
  name: Apache APISIX Dashboard <2.10.1 API Unauthorized Access
  author:
  - l0ne1y
  description: |-
    Apache APISIX Dashboard 认证绕过漏洞
    Apache Apisix是美国阿帕奇（Apache）基金会的一个云原生的微服务API网关服务。该软件基于 OpenResty 和 etcd 来实现，具备动态路由和插件热加载，适合微服务体系下的 API 管理。

    Apache APISIX Dashboard 存在访问控制错误漏洞，该漏洞源于 Manager API使用了两个框架，在 gin 框架的基础上引入了 droplet 框架，所有的 API 和鉴权中间件都是基于 droplet 框架开发的，但是有些API直接使用了 框架 gin 的接口从而绕过身份验证。
  severity: critical
  remediation: |
    **官方修复方案**
    目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://lists.apache.org/thread/979qbl6vlm8269fopfyygnxofgqyn6k5

    **临时修复方案**
    1、关键路径禁止直接暴漏在互联网，需通过VPN等较为安全的接入方式访问内部系统。
    2、后台管理系统所有页面开启身份认证，根据情况选择对应方式（认证用户，用户名密码）。
    3、限制IP访问，绑定固定的IP访问后台管理系统。
    4、采用成熟的权限管理框架，如spring security。
requests:
- matchers:
  - type: word
    words:
    - '"Consumers":'
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{RootURL}}/apisix/admin/migrate/export'
  method: GET
