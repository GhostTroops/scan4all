id: CVE-2014-9618
info:
  name: Netsweeper - Authentication Bypass
  author:
  - l0ne1y
  description: |-
    Netsweeper 认证绕过漏洞
    Netsweeper是加拿大Netsweeper公司的一套Web内容过滤解决方案。Client Filter Admin portal是其中的一个过滤器管理程序。

    Netsweeper 3.1.10之前的版本、4.0.9之前的4.0.x版本和4.1.2之前的4.1.x版本中的Client Filter Admin portal存在安全漏洞。远程攻击者可利用该漏洞绕过身份验证，创建任意的配置文件。
  severity: critical
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：
    http://www.netsweeper.com/

    临时修复方案：
    1、前后端同时对用户输入信息进行校验，双重验证机制。
    2、调用功能前验证用户是否有权限调用相关功能。
    3、用户进行访问操作的凭证（如用户ID、产品号码、订单流水号等）优先采用在服务端关联session或加密后放在session中的方式获取。
    4、对管理功能模块进行严格的权限验证，如非必要建议不对互联网开放或进行网络层的访问控制。
requests:
- matchers:
  - type: word
    condition: and
    part: body
    words:
    - name=formtag action="../clientlogin/?srid=&action=showdeny&url="
    - placeholder="Profile Manager">
    - <title>Netsweeper WebAdmin</title>
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/webadmin/clientlogin/?srid=&action=showdeny&url='
  method: GET
