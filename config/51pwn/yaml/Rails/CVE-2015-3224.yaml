id: CVE-2015-3224
info:
  name: Ruby on Rails Web Console - Remote Code Execution
  author:
  - l0ne1y
  description: |-
    Rails webconsole 访问绕过导致代码执行漏洞
    Ruby on Rails（Rails）是Rails核心团队开发维护的一套基于Ruby语言的开源Web应用框架，它是由大卫-海纳梅尔-韩森从美国37signals公司的项目管理工具Basecamp里分离出来的。Web Console是一套基于Web的用于在服务器上执行shell命令的应用程序。

    Ruby on Rails中使用的Web Console中的request.rb文件存在安全漏洞，该漏洞源于程序确定客户端IP地址时没有限制使用X-Forwarded-For头。远程攻击者可通过发送特制的请求利用该漏洞绕过whitelisted_ips保护机制。以下产品及版本受到影响：Ruby on Rails 3.x版本和4.x版本，Web Console 2.1.3之前版本。
  severity: high
  remediation: |-
    官方修复方案：
    1.目前厂商已经发布了升级补丁以修复此安全问题，补丁获取链接：
    https://github.com/rails/web-console/blob/master/CHANGELOG.markdown
requests:
- matchers:
  - type: word
    condition: and
    part: body
    words:
    - 'Rails.root:'
    - 'Action Controller: Exception caught'
  - type: word
    condition: or
    part: response
    words:
    - data-remote-path=
    case-insensitive: true
  matchers-condition: and
  path:
  - '{{BaseURL}}/{{randstr}}'
  method: GET
  headers:
    X-Forwarded-For: ::1
