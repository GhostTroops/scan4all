id: CVE-2019-11248
info:
  name: exposed_pprof
  author:
  - l0ne1y
  description: |-
    Kubelet /debug/pprof 信息泄漏漏洞
    Google Kubernetes是美国谷歌（Google）公司的一套开源的Docker容器集群管理系统。该系统为容器化的应用提供资源调度、部署运行、服务发现和扩容缩容等功能。Kubelet 是 Kubernetes 的核心组件之一。
    默认情况下，Kubelet 的 healthz 节在10248端口对外开放且无身份验证，但仅限于 localhost 。如果该节点使用非本地的 healthzBindAddress (--health-bind-address) 和旧版本，则存在信息泄露的风险。1.15.0、1.14.4、1.13.8 和 1.12.10 之前的版本会受到影响。
  severity: low
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：
    https://github.com/kubernetes/kubernetes/issues/81023

    临时修复方案：
    1、配置所有的安全机制
    2、最小原则，关掉或限制不使用的服务
    3、更改默认账户信息
    4、使用日志和警报
    5、回显信息不显示任何与实际错误相关的信息
    6、检查和修复安全配置项
    7、更新节点配置将“healthzBindAddress”设置为“127.0.0.1”
requests:
- matchers:
  - type: word
    condition: or
    words:
    - 'Types of profiles available:'
    - Profile Descriptions
    - 'goroutine profile: total'
  path:
  - '{{BaseURL}}/debug/pprof/'
  - '{{BaseURL}}/debug/pprof/goroutine?debug=1'
  method: GET
  stop-at-first-match: true
