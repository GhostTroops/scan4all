id: CVE-2021-33221
info:
  name: CommScope Ruckus IoT Controller - Information Disclosure
  author:
  - geeknik
  description: |-
    CommScope Ruckus IoT Controller API端点未授权访问
    CommScope Ruckus IoT Controller是美国康普（Commscope）公司的一款物联网控制器。与SmartZone控制器集成的虚拟控制器，可为非Wi-Fi设备执行连接，设备和安全管理功能。

    CommScope Ruckus IoT Controller 1.7.1.0 版本及之前版本中存在未授权访问漏洞，该漏洞源于系统中有三个 API 端点无需身份验证即可访问，其中两个端点会导致信息泄漏和计算/存储资源的消耗，不需要身份验证的第三个 API 端点允许物联网控制器恢复出厂设置。
  severity: high
  remediation: |-
    官方修复方案：
    1、目前厂商已发布升级补丁以修复漏洞，详情请关注厂商主页：
    https://www.commscope.com/globalassets/digizuite/917216-faq-security-advisory-id-20210525-v1-0.pdf

    临时修复方案：
    1、前后端同时对用户输入信息进行校验，双重验证机制。
    2、调用功能前验证用户是否有权限调用相关功能。
requests:
- matchers:
  - type: word
    part: header
    words:
    - application/json
  - type: word
    condition: and
    words:
    - message
    - ok
    - data
    - dns
    - gateway
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/service/v1/service-details'
  method: GET
