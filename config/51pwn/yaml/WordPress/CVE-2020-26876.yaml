id: CVE-2020-26876
info:
  name: WordPress WP Courses Plugin Information Disclosure
  author:
  - l0ne1y
  tags:
  - wordpress
  - plugin
  description: |-
    WordPress Plugin wp-courses 存在付款逻辑漏洞
    WordPress是WordPress基金会的一套使用PHP语言开发的博客平台。该平台支持在PHP和MySQL的服务器上架设个人博客网站。iframe是使用在其中的一个用于将另一个文档嵌入当前HTML文档中的内联框架。

    WordPress 2.0.27版本 插件 wp-courses存在安全漏洞，该漏洞源于show_in_rest启用自定义职位类型(例如,/wp-json/wp/v2/course and /wp-json/wp/v2/lesson exist)。攻击者可利用该漏洞绕过指定的付款步骤(课程视频和资料)通过使用/ wp-json REST API,利用2020年9月在野外。
  reference:
  - https://nvd.nist.gov/vuln/detail/cve-2020-26876
  - https://www.exploit-db.com/exploits/48910
  - https://www.redtimmy.com/critical-information-disclosure-on-wp-courses-plugin-exposes-private-course-videos-and-materials/
  - https://plugins.trac.wordpress.org/changeset/2388997
  severity: high
  classification:
    cve-id:
    - cve-2020-26876
    cwe-id:
    - cwe-306
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
  remediation: |-
    官方修复方案：
    1.建议使用此软件的用户随时关注厂商主页或参考网址以获取解决办法：
    https://plugins.trac.wordpress.org/changeset/2388997
requests:
- matchers:
  - type: regex
    condition: or
    part: body
    regex:
    - rest_post_invalid_id
    - '"(guid|title|content|excerpt)":{"rendered":'
  - type: word
    part: header
    words:
    - application/json
  - type: status
    condition: or
    status:
    - 200
    - 404
  matchers-condition: and
  path:
  - '{{BaseURL}}/wp-json/wp/v2/lesson/1'
  method: GET
