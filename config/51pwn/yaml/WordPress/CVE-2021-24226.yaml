id: CVE-2021-24226
info:
  name: AccessAlly < 3.5.7 - $_SERVER Superglobal Leakage
  author:
  - l0ne1y
  description: |-
    WordPress Plugin AccessAlly 信息泄漏漏洞
    WordPress是WordPress（Wordpress）基金会的一套使用PHP语言开发的博客平台。该平台支持在PHP和MySQL的服务器上架设个人博客网站。

    AccessAlly WordPress插件 3.5.7版本之前存在信息泄露漏洞，该漏洞源于插件中负责[accessally_order_form]短代码的文件“ resource / frontend / product / product-shortcode.php”正在转储包含所有环境变量的serialize（$ _ SERVER）。在包含[accessally_order_form]短代码的所有面向公众的页面上都会发生泄漏，不需要登录或管理员角色。
  severity: high
  remediation: |-
    官方修复方案:
    1.目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://wpscan.com/vulnerability/8e3e89fd-e380-4108-be23-00e87fbaad16
requests:
- matchers:
  - type: word
    condition: and
    part: body
    words:
    - <div id="accessally-testing-data"
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}'
  method: GET
