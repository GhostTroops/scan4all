id: CVE-2020-35489
info:
  name: WordPress Contact Form 7 - Unrestricted File Upload
  author:
  - l0ne1y
  description: |+
    Wordpress Plugin Contact Form 7 任意文件上传漏洞
    Wordpress contact-form-7是Wordpress基金会的一个为Wordpress提供表单的插件。

    contact-form-7 (aka Contact Form 7) plugin 5.3.2之前版本存在安全漏洞，该漏洞允许不受限制的文件上传和远程代码执行，因为文件名可能包含特殊字符。

  severity: critical
  remediation: |-
    官方修复方案:
    1.目前厂商已发布升级补丁以修复漏洞，详情请关注厂商主页：
    https://wordpress.org/plugins/contact-form-7/#developers
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: word
    condition: and
    part: body
    words:
    - Contact Form 7
    - == Changelog ==
  - type: dsl
    dsl:
    - compare_versions(version, '< 5.3.2')
  extractors:
  - name: version
    type: regex
    regex:
    - '(?m)Stable tag: ([0-9.]+)'
    group: 1
    internal: true
  - type: regex
    regex:
    - '(?m)Stable tag: ([0-9.]+)'
    group: 1
  matchers-condition: and
  path:
  - '{{BaseURL}}/wp-content/plugins/contact-form-7/readme.txt'
  method: GET
