id: CVE-2018-8719
info:
  name: WordPress Plugin WP Security Audit Log 3.1.1 - Information Disclosure
  author:
  - l0ne1y
  tags:
  - wordpress
  - wp-plugin
  - cve
  - cve2018
  - exposure
  description: |-
    WordPress Plugin WP Security Audit Log 未授权访问导致信息泄漏漏洞
    WordPress是WordPress软件基金会的一套使用PHP语言开发的博客平台，该平台支持在PHP和MySQL的服务器上架设个人博客网站。WP Security Audit Log plugin是使用在其中的一个日志安全审计插件。

    WordPress WP Security Audit Log插件3.1.1版本中存在安全漏洞，该漏洞源于程序没有限制wp-content/uploads/wp-security-audit-log/*文件的访问权限。攻击者可利用该漏洞获取敏感信息。
  reference:
  - https://www.exploit-db.com/exploits/44371
  - https://vuldb.com/?id.115817
  - https://www.cvedetails.com/cve/cve-2018-8719/
  - https://www.exploit-db.com/exploits/44371/
  severity: medium
  classification:
    cve-id:
    - cve-2018-8719
    cwe-id:
    - cwe-532
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：https://wordpress.org/plugins/wp-security-audit-log/

    临时修复方案：
    1、敏感路径禁止直接暴漏在互联网，需通过VPN等较为安全的接入方式访问内部系统。
    2、敏感路径所有页面开启身份认证，根据情况选择对应方式（认证用户，用户名密码）。
    3、限制IP访问，绑定固定的IP访问敏感路径。
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: word
    condition: and
    words:
    - '[TXT]'
    - .log
    - Index of
  matchers-condition: and
  path:
  - '{{BaseURL}}/wp-content/uploads/wp-security-audit-log/failed-logins/'
  method: GET
