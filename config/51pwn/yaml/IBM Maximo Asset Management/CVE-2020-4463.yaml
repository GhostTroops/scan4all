id: CVE-2020-4463
info:
  name: IBM Maximo Asset Management Information Disclosure via XXE
  author:
  - dwisiswant0
  tags:
  - cve
  - cve2020
  - ibm
  - xxe
  - disclosure
  description: |-
    IBM Maximo Asset Management XXE
    IBM Maximo Asset Management是美国IBM公司的一套综合性资产生命周期和维护管理解决方案。该方案能够在一个平台上管理所有类型的资产，如设施、交通运输等，并对这些资产实现单点控制。 IBM Maximo Asset Management 7.6.0版本和7.6.1版本中存在代码问题漏洞，该漏洞源于程序没有正确处理XML外部实体。远程攻击者可利用该漏洞泄露敏感信息或消耗内存资源。
  reference:
  - https://www.ibm.com/support/pages/security-bulletin-ibm-maximo-asset-management-vulnerable-information-disclosure-cve-2020-4463
  - https://github.com/ibonok/cve-2020-4463
  - https://exchange.xforce.ibmcloud.com/vulnerabilities/181484
  - https://www.ibm.com/support/pages/node/6253953
  severity: high
  classification:
    cve-id:
    - cve-2020-4463
    cwe-id:
    - cwe-611
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:L
    cvss-score: 8.2
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：https://www.ibm.com/support/pages/node/6253953

    临时修复方案：
    1、禁用外部实体
    2、过滤用户提交的XML数据，关键词：<!DOCTYPE和<!ENTITY，或者，SYSTEM和PUBLIC
    ```
requests:
- matchers:
  - type: word
    part: header
    words:
    - application/xml
  - type: word
    part: body
    words:
    - QueryMXPERSONResponse
    - MXPERSONSet
  matchers-condition: and
  path:
  - '{{BaseURL}}/os/mxperson'
  - '{{BaseURL}}/meaweb/os/mxperson'
  method: POST
  body: |
    <?xml version='1.0' encoding='UTF-8'?>
    <max:QueryMXPERSON xmlns:max='http://www.ibm.com/maximo'>
      <max:MXPERSONQuery></max:MXPERSONQuery>
    </max:QueryMXPERSON>
  headers:
    Content-Type: application/xml
