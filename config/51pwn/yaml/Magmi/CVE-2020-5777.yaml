id: CVE-2020-5777
info:
  name: Magento Mass Importer  <0.7.24 - Remote Auth Bypass
  author:
  - l0ne1y
  description: |-
    MAGMI 插件身份验证绕过漏洞
    Adobe MAGMI是美国奥多比（Adobe）公司的轻量级 UI 组件。

    MAGMI 存在授权问题漏洞，该漏洞源于数据库连接失败时允许使用默认凭据。攻击者可以触发此连接失败从而绕过身份验证。
  severity: high
  remediation: |-
    官方修复方案：
    1、建议用户到官方获取最新补丁或者最新版本程序：
    http://wiki.magmi.org/index.php/Magmi_Wiki

    临时修复方案：
    1、前后端同时对用户输入信息进行校验，双重验证机制。
    2、调用功能前验证用户是否有权限调用相关功能。
requests:
- matchers:
  - type: word
    part: body
    words:
    - Too many connections
  - type: status
  matchers-condition: and
  raw:
  - |
    GET /index.php/catalogsearch/advanced/result/?name=e HTTP/1.1
    Host: {{Hostname}}
    Connection: close
