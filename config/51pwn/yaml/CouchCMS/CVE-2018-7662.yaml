id: CVE-2018-7662
info:
  name: CouchCMS <= 2.0 - Path Disclosure
  author:
  - l0ne1y
  description: |-
    Webzyme Couch路径泄露漏洞
    Webzyme Couch是美国Webzyme Softwares公司的一套开源内容管理系统（CMS）。

    Webzyme Couch中存在安全漏洞。远程攻击者可通过向includes/mysql2i/mysql2i.func.php或addons/phpmailer/phpmailer.php文件发送直接请求利用该漏洞获取完整路径。
  severity: medium
  remediation: |-
    官方修复方案：
    1、目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://github.com/CouchCMS/CouchCMS/issues/46
requests:
- matchers:
  - type: word
    condition: and
    part: body
    words:
    - mysql2i.func.php on line 10
    - 'Fatal error: Cannot redeclare mysql_affected_rows() in'
  - type: word
    condition: and
    part: body
    words:
    - phpmailer.php on line 10
    - 'Fatal error: Call to a menber function add_event_listener() on a non-object
      in'
  matchers-condition: or
  path:
  - '{{BaseURL}}/includes/mysql2i/mysql2i.func.php'
  - '{{BaseURL}}/addons/phpmailer/phpmailer.php'
  method: GET
  stop-at-first-match: true
