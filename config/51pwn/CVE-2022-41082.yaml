id: CVE-2022-41082_51pwn

info:
  name: Exchange 0-day vuln  CVE-2022-41082 RCE
  author: 51pwn
  severity: critical
  description: |
    Checks for specific Exchange 0-day vuln: CVE-2022-41082
    (if virtual patching succeeded)
    The script will follow up to 5 HTTP redirects, using the default rules in the
    http library.
  reference:
    - https://www.microsoft.com/security/blog/2022/09/30/analyzing-attacks-using-the-exchange-vulnerabilities-cve-2022-41040-and-cve-2022-41082/
    - https://msrc-blog.microsoft.com/2022/09/29/customer-guidance-for-reported-zero-day-vulnerabilities-in-microsoft-exchange-server/
    - https://microsoft.github.io/CSS-Exchange/Security/EOMTv2/
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-41082
  classification:
    cvss-metrics: CVSS:2/AV:N/AC:L/AU:N/C:C/I:C/A:C
    cvss-score: 10
    cve-id: CVE-2022-41082
  tags: cve,cve2022,41082,rce,exchange

requests:
  - method: GET
    path: 
      - "{{BaseURL}}/autodiscover/autodiscover.json@Powershell.{{randstr}}.com/owa/"
    redirects: true
    max-redirects: 2
    matchers-condition: and
    matchers:
      - type: status
        status:
        - 401
        condition: and
      - type: word
        part: header
        words:
          - "x-owa-version"
        condition: and


# Enhanced by mp on 2022/07/06
