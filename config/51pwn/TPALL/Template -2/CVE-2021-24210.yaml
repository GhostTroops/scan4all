id: CVE-2021-24210

info:
  name: PhastPress < 1.111 - Open Redirect
  author: 0x_Akoko
  description: There is an open redirect in the plugin that allows an attacker to malform a request to a page with the plugin and then redirect the victim to a malicious page.
  reference: https://wpscan.com/vulnerability/9b3c5412-8699-49e8-b60c-20d2085857fb
  severity: low
  tags: wordpress,cve,cve2021,redirect

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/phastpress/phast.php?service=scripts&src=https%3A%2F%2Fexample.com"

    matchers:
      - type: regex
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?://|//)?(?:[a-zA-Z0-9\-_\.@]*)example\.com.*$'
        part: header
