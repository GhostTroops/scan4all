id: foulenzer-tech-exploit
info:
  name: WebApp-Scan with automated bug scan
  author: foulenzer
variables:

  tech_detect: foulenzer-tech.yaml

  # cisco asa
  cisco_detect: panels/cisco-asa-panel.yaml
  cisco_asa_1: cves/CVE-2018-0296.yaml
  cisco_asa_2: cves/CVE-2019-1653.yaml
  cisco_asa_3: cves/CVE-2020-16139.yaml
  cisco_asa_4: cves/CVE-2020-3187.yaml
  cisco_asa_5: cves/CVE-2020-3452.yaml
  
  # citrix
  citrix_detect: panels/citrix-adc-gateway-detect.yaml
  citrix_1: cves/CVE-2019-19781.yaml
  citrix_2: cves/CVE-2020-8191.yaml
  citrix_3: cves/CVE-2020-8193.yaml
  citrix_4: cves/CVE-2020-8194.yaml
  citrix_5: cves/CVE-2020-8982.yaml

  # confluence
  confluence_cve: cves/CVE-2018-5230.yaml
  confluence_cve2: cves/CVE-2019-3396.yaml

  # drupal
  drupal: security-misconfiguration/drupal-user-enum-ajax.yaml
  drupal2: security-misconfiguration/drupal-user-enum-redirect.yaml

  # grafana:
  grafana_detect: panels/grafana-detect.yaml
  grafana_default_cred: default-credentials/grafana-default-credential.yaml
  grafana_cve: cves/CVE-2019-15043.yaml

  # jenkins
  jenkins_dashboard: security-misconfiguration/unauthenticated-jenkin-dashboard.yaml
  jenkins_cve_1: cves/CVE-2019-10475.yaml
  jenkins_cve_2: cves/CVE-2020-2096.yaml
  jenkins_cve_3: cves/CVE-2020-2140.yaml

  # jira
  jira_signup: security-misconfiguration/jira-service-desk-signup.yaml
  jira_projects: security-misconfiguration/jira-unauthenticated-projects.yaml
  jira_dashboard: security-misconfiguration/jira-unauthenticated-dashboards.yaml
  jira_filters: security-misconfiguration/jira-unauthenticated-popular-filters.yaml
  jira_user_picker: security-misconfiguration/jira-unauthenticated-user-picker.yaml
  jira_cve_1: cves/CVE-2019-8449.yaml
  jira_cve_2: cves/CVE-2019-8451.yaml
  jira_cve_3: cves/CVE-2017-9506.yaml
  jira_cve_4: cves/CVE-2018-20824.yaml
  jira_cve_5: cves/CVE-2019-3396.yaml
  jira_cve_6: cves/CVE-2020-14179.yaml
  jira_cve_7: cves/CVE-2020-14181.yaml
  jira_cve_8: cves/CVE-2019-8442.yaml

  # moodle
  moodle_1: vulnerabilities/moodle-filter-jmol-lfi.yaml
  moodle_2: vulnerabilities/moodle-filter-jmol-xss.yaml

  # tomcat
  cve_2020_9484: cves/CVE-2020-9484.yaml
  public_tomcat_instance: files/public-tomcat-instance.yaml
  tomcat_scripts: files/tomcat-scripts.yaml
  tomcat_manager_pathnormalization: vulnerabilities/tomcat-manager-pathnormalization.yaml
  cve_2018_11759: cves/CVE-2018-11759.yaml
  tomcat_manager_default: default-credentials/tomcat-manager-default.yaml

  # typo3 cms
  typo3_cve: cves/CVE-2020-8091.yaml

  # wordpress
  wordpress_wpconfig: security-misconfiguration/wordpress-accessible-wpconfig.yaml
  wordpress_duplicator_path_traversal: vulnerabilities/wordpress-duplicator-path-traversal.yaml
  wordpress_wordfence_xss: vulnerabilities/wordpress-wordfence-xss.yaml
  wordpress_db_backup: files/wordpress-db-backup.yaml
  wordpress_emergency_script: files/wordpress-emergency-script.yaml
  wordpress_installer_log: files/wordpress-installer-log.yaml
  wordpress_tmm_db_migrate: files/wordpress-tmm-db-migrate.yaml
  wordpress_social_metrics_tracker: vulnerabilities/wordpress-social-metrics-tracker.yaml
  wordpress_cve: cves/CVE-2019-9978.yaml
  wordpress_cve_2: cves/CVE-2019-6715.yaml
  wordpress_cve_3: cves/CVE-2020-24312.yaml
  wordpress_cve_4: cves/CVE-2019-6112.yaml
  wordpress_cve_5: cves/CVE-2018-18069.yaml
  wordpress_cve_6: cves/CVE-2019-19985.yaml
  wordpress_cve_7: cves/CVE-2019-15858.yaml
  wordpress_cve_8: cves/CVE-2017-14537.yaml
  wordpress_cve_9: CVE/CVE-2020-25213.yaml
  
logic:
  |

  if cisco_detect() {

    cisco_asa_1()
    cisco_asa_2()
    cisco_asa_3()
    cisco_asa_4()
    cisco_asa_5()

  }

  if citrix_detect() {

    citrix_1()
    citrix_2()
    citrix_3()
    citrix_4()
    citrix_5()

  }

  if grafana_detect() {

  grafana_default_cred()
  grafana_cve()

  }

  tech_detect()

  if tech_detect["atlassian-confluence"] {
    confluence_cve()
    confluence_cve2()
  }

  if tech_detect["drupal"] {
    drupal()
    drupal2()
  }

  if tech_detect["atlassian-jira"] {

    jira_signup()
    jira_projects()
    jira_dashboard()
    jira_filters()
    jira_user_picker()
    jira_cve_1()
    jira_cve_2()
    jira_cve_3()
    jira_cve_4()
    jira_cve_5()
    jira_cve_6()
    jira_cve_7()
    jira_cve_8()

  }

  if tech_detect["jenkins"] {
    jenkins_dashboard()
    jenkins_cve_1()
    jenkins_cve_2()
    jenkins_cve_3()
  }

  if tech_detect["moodle"] {
    moodle_1()
    moodle_1()
  }

  if tech_detect["tomcat"] {
    cve_2020_9484()
    public_tomcat_instance()
    tomcat_scripts()
    tomcat_manager_pathnormalization()
    cve_2018_11759()
    tomcat_manager_default()
  }

  if tech_detect["typo3-cms"] {
    typo3_cve()
  }

  if tech_detect["wordpress"] {

    wordpress_wpconfig()
    wordpress_duplicator_path_traversal()
    wordpress_wordfence_xss()
    wordpress_db_backup()
    wordpress_emergency_script()
    wordpress_installer_log()
    wordpress_tmm_db_migrate()
    wordpress_social_metrics_tracker()
    wordpress_cve()
    wordpress_cve_2()
    wordpress_cve_3()
    wordpress_cve_4()
    wordpress_cve_5()
    wordpress_cve_6()
    wordpress_cve_7()
    wordpress_cve_8()
    wordpress_cve_9()

  }

