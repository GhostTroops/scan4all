id: cve-2020-5377
info:
  name: Dell OpenManage Administrator Auth Bypass CVE-2020-5377
  risk: High

params:
  - root: "{{.BaseURL}}"

replicate:
  ports: '8010'

requests:
  - method: POST
    redirect: false
    url: >-
      {{.root}}/LoginServlet?flag=true&managedws=false
    headers:
      - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55
      - Content-Type: 'application/x-www-form-urlencoded'
    body: |
      manuallogin=true&targetmachine=0.0.0.0&ignorecertificate=1&application=omsa&user=VULNERABILITY%3ACVE-2020-5377&password=plz
    detections:
      - >-
        StatusCode() >= 300 && StringSearch("resHeaders", "JSESSIONID=") && StringSearch("resHeaders", ";Path=/") && StringSearch("resHeaders", "?msgStatus=false&manageDWS=false&PasswordEmpty=false")

references:
  - link: https://rhinosecuritylabs.com/research/cve-2020-5377-dell-openmanage-server-administrator-file-read/