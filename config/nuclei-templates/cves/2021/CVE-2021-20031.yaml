id: CVE-2021-20031

info:
  name: Sonicwall SonicOS 7.0 - Host Header Injection
  author: gy741
  severity: medium
  description: A Host Header Injection vulnerability may allow an attacker to spoof a particular Host header, allowing the attacker to render arbitrary links that point to a malicious website with poisoned Host header webpages. An issue was discovered in Sonicwall NAS, SonicWall Analyzer version 8.5.0 (may be affected on other versions too). The values of the 'Host' headers are implicitly set as trusted while this should be forbidden, leading to potential host header injection attack and also the affected hosts can be used for domain fronting. This means affected hosts can be used by attackers to hide behind during various other attack
  reference:
    - https://www.exploit-db.com/exploits/50414
    - https://nvd.nist.gov/vuln/detail/CVE-2021-20031
    - https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0019
    - http://packetstormsecurity.com/files/164502/Sonicwall-SonicOS-7.0-Host-Header-Injection.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-20031
    cwe-id: CWE-601
  metadata:
    google-dork: inurl:"auth.html" intitle:"SonicWall"
  tags: sonicwall,redirect,edb,packetstorm,cve,cve2021

requests:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{randstr}}.tld

    matchers-condition: and
    matchers:
      - type: word
        words:
          - 'https://{{randstr}}.tld/auth.html'
          - 'Please be patient as you are being re-directed'
        part: body
        condition: and

      - type: status
        status:
          - 200
