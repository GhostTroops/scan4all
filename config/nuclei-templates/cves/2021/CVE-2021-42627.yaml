id: CVE-2021-42627

info:
  name: D-Link DIR-615 - Unauthorized Access
  author: For3stCo1d
  severity: critical
  description: |
    The WAN configuration page "wan.htm" on D-Link DIR-615 devices with firmware 20.06 can be accessed directly without authentication which can lead to disclose the information about WAN settings and also leverage attacker to modify the data fields of page.
  reference:
    - https://github.com/sanjokkarki/D-Link-DIR-615/blob/main/CVE-2021-42627
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-42627
    - https://www.dlink.com/en/security-bulletin/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-42627
  metadata:
    shodan-query: http.title:"Roteador Wireless"
    verified: "true"
  tags: cve,cve2021,d-link,router,unauth,dir-615,roteador

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wan.htm"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "src='menu.js?v=\"+Math.random()+\"'></scr\"+\"ipt>\");"
          - "var ipv6conntype"
        condition: and

      - type: word
        part: header
        words:
          - Virtual Web

      - type: status
        status:
          - 200
